select * from dbo.MCC_PARTY -- now 14159 rows after running copy at 12:35 25/07/2022

select count(*) from dbo.MCC_PARTY

select count(distinct PAR_SEQ_NUM) from dbo.MCC_PARTY

-- ID is PAR_SEQ_NUM, latest_update is LAST_UPDATE_TSTMP

select * from dbo.MCC_PARTY where BROKER_TYPE is null -- all are null atm

----------------------------------------------------------------------------------------------
-- COPY RAN AGAIN
----------------------------------------------------------------------------------------------

select * from dbo.MCC_PARTY -- now 14160 rows after running copy at 13:25 26/07/2022

-- creating partywatermarktable

DROP TABLE IF EXISTS partywatermarktable

CREATE TABLE partywatermarktable
(
PartyWatermarkValue datetime,
);

INSERT INTO partywatermarktable
VALUES ('1800-07-25 13:01:00')

-- Create the procedure for delta load (links to ADF code)

CREATE OR ALTER PROCEDURE party_update_watermark @PartyLastModifiedtime datetime
AS

BEGIN

    UPDATE partywatermarktable
    SET [PartyWatermarkValue] = @PartyLastModifiedtime 

END


-- creating TabParty for updates

DROP TABLE IF EXISTS TabParty

CREATE TABLE TabParty (
    PAR_SEQ_NUM int NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(12),
	SRCE_SYSTEM_KEY nvarchar(32),
	SHORT_NAME_TXT nvarchar(500),
	LONG_NAME_TXT nvarchar(500),
	PHONE_TXT nvarchar(64),
	FAX_TXT nvarchar(64),
	CREATED_BY_USERID nvarchar(64),
	CREATED_TSTMP datetime2(0),
	LAST_UPDATE_USERID nvarchar(64),
	LAST_UPDATE_TSTMP datetime2(0),
	SECURITY_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_DATE_TXT nvarchar(255),
	NETTING_AGREEMENT_IND nvarchar(1),
	SAP_VENDOR_CODE nvarchar(15),
	AFFILIATE_COMP_IND nvarchar(1),
	BROKER_IND nvarchar(1),
	AUTH_SEQ_NUM decimal(9, 0),
	SHELL_ENTITY_IND nvarchar(1),
	EU_CTPY_IND nvarchar(1),
	CPTY_CREDIT_LIMIT_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_STOP_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_CER_AMT nvarchar(MAX),
	CPTY_PARENT_TXT nvarchar(500),
	CSA_IND nvarchar(1),
	CPTY_NFC_IND nvarchar(64),
	CORP_SECTOR nvarchar(25),
	INTRAGROUP_IND nvarchar(1),
	COUNTRY_CODE nvarchar(32),
	UK_CTPY_IND nvarchar(1),
	EXEMPT_IND nvarchar(1),
	BROKER_TYPE nvarchar(64),
	PRIMARY KEY (PAR_SEQ_NUM)
	);

INSERT INTO TabParty (PAR_SEQ_NUM, SRCE_SYSTEM_CODE, SRCE_SYSTEM_KEY, SHORT_NAME_TXT, LONG_NAME_TXT, PHONE_TXT, FAX_TXT, CREATED_BY_USERID, CREATED_TSTMP, LAST_UPDATE_USERID,
	LAST_UPDATE_TSTMP, SECURITY_TYPE_TXT, MASTERAGREEMENT_TYPE_TXT, MASTERAGREEMENT_DATE_TXT, NETTING_AGREEMENT_IND, SAP_VENDOR_CODE, AFFILIATE_COMP_IND, BROKER_IND,
	AUTH_SEQ_NUM, SHELL_ENTITY_IND, EU_CTPY_IND, CPTY_CREDIT_LIMIT_AMT, CPTY_CREDIT_LIMIT_STOP_AMT, CPTY_CREDIT_LIMIT_CER_AMT, CPTY_PARENT_TXT, CSA_IND, CPTY_NFC_IND,
	CORP_SECTOR, INTRAGROUP_IND, COUNTRY_CODE, UK_CTPY_IND, EXEMPT_IND, BROKER_TYPE)
select PAR_SEQ_NUM, SRCE_SYSTEM_CODE, SRCE_SYSTEM_KEY, SHORT_NAME_TXT, LONG_NAME_TXT, PHONE_TXT, FAX_TXT, CREATED_BY_USERID, CREATED_TSTMP, LAST_UPDATE_USERID,
	LAST_UPDATE_TSTMP, SECURITY_TYPE_TXT, MASTERAGREEMENT_TYPE_TXT, MASTERAGREEMENT_DATE_TXT, NETTING_AGREEMENT_IND, SAP_VENDOR_CODE, AFFILIATE_COMP_IND, BROKER_IND,
	AUTH_SEQ_NUM, SHELL_ENTITY_IND, EU_CTPY_IND, CPTY_CREDIT_LIMIT_AMT, CPTY_CREDIT_LIMIT_STOP_AMT, CPTY_CREDIT_LIMIT_CER_AMT, CPTY_PARENT_TXT, CSA_IND, CPTY_NFC_IND,
	CORP_SECTOR, INTRAGROUP_IND, COUNTRY_CODE, UK_CTPY_IND, EXEMPT_IND, BROKER_TYPE from 
	(select *, 
	MAX(LAST_UPDATE_TSTMP) OVER(PARTITION BY PAR_SEQ_NUM) AS Max_date
	from dbo.MCC_PARTY
	where (PAR_SEQ_NUM IN (select PAR_SEQ_NUM
	from dbo.MCC_PARTY
	group by PAR_SEQ_NUM
	having count(PAR_SEQ_NUM) > 1))) as t2
where LAST_UPDATE_TSTMP = Max_date

select * from TabParty

-- Create a test table to check it matches the copy data pipeline

DROP TABLE IF EXISTS deltaPartyTest

CREATE TABLE deltaPartyTest (
    PAR_SEQ_NUM int NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(12),
	SRCE_SYSTEM_KEY nvarchar(32),
	SHORT_NAME_TXT nvarchar(500),
	LONG_NAME_TXT nvarchar(500),
	PHONE_TXT nvarchar(64),
	FAX_TXT nvarchar(64),
	CREATED_BY_USERID nvarchar(64),
	CREATED_TSTMP datetime2(0),
	LAST_UPDATE_USERID nvarchar(64),
	LAST_UPDATE_TSTMP datetime2(0),
	SECURITY_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_DATE_TXT nvarchar(255),
	NETTING_AGREEMENT_IND nvarchar(1),
	SAP_VENDOR_CODE nvarchar(15),
	AFFILIATE_COMP_IND nvarchar(1),
	BROKER_IND nvarchar(1),
	AUTH_SEQ_NUM decimal(9, 0),
	SHELL_ENTITY_IND nvarchar(1),
	EU_CTPY_IND nvarchar(1),
	CPTY_CREDIT_LIMIT_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_STOP_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_CER_AMT nvarchar(MAX),
	CPTY_PARENT_TXT nvarchar(500),
	CSA_IND nvarchar(1),
	CPTY_NFC_IND nvarchar(64),
	CORP_SECTOR nvarchar(25),
	INTRAGROUP_IND nvarchar(1),
	COUNTRY_CODE nvarchar(32),
	UK_CTPY_IND nvarchar(1),
	EXEMPT_IND nvarchar(1),
	BROKER_TYPE nvarchar(64),
	PRIMARY KEY (PAR_SEQ_NUM)
	);

select * from dbo.MCC_PARTY
select * from dbo.deltaPartyTest

DROP TABLE IF EXISTS PARSEQParty


CREATE TABLE PARSEQParty (
    PAR_SEQ_NUM int NOT NULL,
	PRIMARY KEY (PAR_SEQ_NUM)
	);

select * from PARSEQParty

-- ATTEMPT 2 JUST DELTA COPY (No delete or update)
-- GET THIS TO WORK FIRST AS THIS WAS FAILING

select MIN(LAST_UPDATE_TSTMP) FROM dbo.MCC_PARTY -- to find the min update date

DROP TABLE IF EXISTS watermarktable

create table watermarktable
(
WatermarkValue datetime,
);
INSERT INTO watermarktable
VALUES ('1/1/1900 12:00:00 AM') -- must be before the min update date

CREATE OR ALTER PROCEDURE update_watermark @LastModifiedtime datetime
AS

BEGIN

    UPDATE watermarktable
    SET [WatermarkValue] = @LastModifiedtime 

END

select * from dbo.deltaPartyTest

exec sp_help deltaPartyTest

select * from dbo.MCC_PARTY

exec sp_help MCC_PARTY

select * from Dummy_Oracle -- To see whats in Dummy_Oracle table

exec sp_help Dummy_Oracle

ALTER TABLE Dummy_Oracle ALTER COLUMN latest_date datetime

-- ATTEMPT 3 JUST DELTA COPY (No delete or update), using DATE instead of datetime 
-- GET THIS TO WORK FIRST AS THIS WAS FAILING

DROP TABLE IF EXISTS watermarktable

create table watermarktable
(
WatermarkValue datetime,
);
INSERT INTO watermarktable
VALUES ('1/1/1900 12:00:00 AM') -- must be before the min update date

CREATE OR ALTER PROCEDURE update_watermark @LastModifiedtime datetime
AS

BEGIN

    UPDATE watermarktable
    SET [WatermarkValue] = @LastModifiedtime 

END

select * from dbo.watermarktable

select * from dbo.deltaPartyTest

DROP TABLE IF EXISTS MCC_PARTY_delta

CREATE TABLE MCC_PARTY_delta (
    PAR_SEQ_NUM decimal(20,1) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(12),
	SRCE_SYSTEM_KEY nvarchar(32),
	SHORT_NAME_TXT nvarchar(500),
	LONG_NAME_TXT nvarchar(500),
	PHONE_TXT nvarchar(64),
	FAX_TXT nvarchar(64),
	CREATED_BY_USERID nvarchar(64),
	CREATED_TSTMP datetime,
	LAST_UPDATE_USERID nvarchar(64),
	LAST_UPDATE_TSTMP datetime,
	SECURITY_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_DATE_TXT nvarchar(255),
	NETTING_AGREEMENT_IND nvarchar(1),
	SAP_VENDOR_CODE nvarchar(15),
	AFFILIATE_COMP_IND nvarchar(1),
	BROKER_IND nvarchar(1),
	AUTH_SEQ_NUM decimal(9, 0),
	SHELL_ENTITY_IND nvarchar(1),
	EU_CTPY_IND nvarchar(1),
	CPTY_CREDIT_LIMIT_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_STOP_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_CER_AMT nvarchar(MAX),
	CPTY_PARENT_TXT nvarchar(500),
	CSA_IND nvarchar(1),
	CPTY_NFC_IND nvarchar(64),
	CORP_SECTOR nvarchar(25),
	INTRAGROUP_IND nvarchar(1),
	COUNTRY_CODE nvarchar(32),
	UK_CTPY_IND nvarchar(1),
	EXEMPT_IND nvarchar(1),
	BROKER_TYPE nvarchar(64),
	PRIMARY KEY (PAR_SEQ_NUM)
	);






select * from dbo.MCC_PARTY_delta








-- DUMMY COPY -- ATTMEPT AT USING UPSERT TO DELTA LOAD

DROP TABLE IF EXISTS Dummy_Oracle
DROP TABLE IF EXISTS Dummy_Output

-- Create the Dummy_Oracle table and intialise it with some data

CREATE TABLE Dummy_Oracle (
    ID int,
	column2 varchar(10),
	create_date datetime,
	latest_date datetime
	);

INSERT INTO Dummy_Oracle (ID, column2, create_date, latest_date)
VALUES	(1, 'value1', '2022-07-25 13:32:00', '2022-07-25 13:47:10'),
		(2, 'value2', '2022-07-25 13:32:00', '2022-07-25 13:47:02'),
		(3, 'value3', '2022-07-25 13:32:00', '2022-07-25 13:47:10');

-- To see update, delete and append run this insert instead

INSERT INTO Dummy_Oracle (ID, column2, create_date, latest_date)
VALUES	(1, 'value1', '2022-07-25 13:32:00', '2022-07-25 13:47:10'),
		(2, 'value2', '2022-07-25 13:32:00', '2022-07-25 13:47:02'),
		(3, 'value3.1', '2022-07-25 13:32:00', '2022-07-25 13:47:20'),
		(4, 'value4', '2022-07-25 13:32:00', '2022-07-25 13:47:20');

-- Removing an ID from the source

INSERT INTO Dummy_Oracle (ID, column2, create_date, latest_date)
VALUES	(1, 'value1', '2022-07-25 13:32:00', '2022-07-25 13:47:10'),
		(2, 'value2', '2022-07-25 13:32:00', '2022-07-25 13:47:02'),
		(3, 'value3.1', '2022-07-25 13:32:00', '2022-07-25 13:47:20');

-- Create the Dummy_Output table (table that will recieve the delta loaded data)

CREATE TABLE Dummy_Output (
    ID int,
	column2 varchar(10),
	create_date datetime,
	latest_date datetime
	);


select * from Dummy_Oracle
select * from Dummy_Output

-- WORKS EXCEPT DELETE PART FOR NOW!!!!!!!!!!!!!!!!!!!!!!

-- MCC_PARTY COPY -- ATTMEPT AT USING UPSERT TO DELTA LOAD

DROP TABLE IF EXISTS MCC_PARTY_delta

CREATE TABLE MCC_PARTY_delta (
    PAR_SEQ_NUM decimal(20,1) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(12),
	SRCE_SYSTEM_KEY nvarchar(32),
	SHORT_NAME_TXT nvarchar(500),
	LONG_NAME_TXT nvarchar(500),
	PHONE_TXT nvarchar(64),
	FAX_TXT nvarchar(64),
	CREATED_BY_USERID nvarchar(64),
	CREATED_TSTMP datetime,
	LAST_UPDATE_USERID nvarchar(64),
	LAST_UPDATE_TSTMP datetime,
	SECURITY_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_DATE_TXT nvarchar(255),
	NETTING_AGREEMENT_IND nvarchar(1),
	SAP_VENDOR_CODE nvarchar(15),
	AFFILIATE_COMP_IND nvarchar(1),
	BROKER_IND nvarchar(1),
	AUTH_SEQ_NUM decimal(9, 0),
	SHELL_ENTITY_IND nvarchar(1),
	EU_CTPY_IND nvarchar(1),
	CPTY_CREDIT_LIMIT_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_STOP_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_CER_AMT nvarchar(MAX),
	CPTY_PARENT_TXT nvarchar(500),
	CSA_IND nvarchar(1),
	CPTY_NFC_IND nvarchar(64),
	CORP_SECTOR nvarchar(25),
	INTRAGROUP_IND nvarchar(1),
	COUNTRY_CODE nvarchar(32),
	UK_CTPY_IND nvarchar(1),
	EXEMPT_IND nvarchar(1),
	BROKER_TYPE nvarchar(64),
	PRIMARY KEY (PAR_SEQ_NUM)
	);

select * from MCC_PARTY_delta -- 141569 rows at 11:43 29/07/2022






select * from MCC_PARTY_delta where LAST_UPDATE_TSTMP > '2022-07-29 09:32:00'


DROP TABLE IF EXISTS MCC_PARTY_control
CREATE TABLE MCC_PARTY_control (
    PAR_SEQ_NUM decimal(20,1) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(12),
	SRCE_SYSTEM_KEY nvarchar(32),
	SHORT_NAME_TXT nvarchar(500),
	LONG_NAME_TXT nvarchar(500),
	PHONE_TXT nvarchar(64),
	FAX_TXT nvarchar(64),
	CREATED_BY_USERID nvarchar(64),
	CREATED_TSTMP datetime,
	LAST_UPDATE_USERID nvarchar(64),
	LAST_UPDATE_TSTMP datetime,
	SECURITY_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_TYPE_TXT nvarchar(255),
	MASTERAGREEMENT_DATE_TXT nvarchar(255),
	NETTING_AGREEMENT_IND nvarchar(1),
	SAP_VENDOR_CODE nvarchar(15),
	AFFILIATE_COMP_IND nvarchar(1),
	BROKER_IND nvarchar(1),
	AUTH_SEQ_NUM decimal(9, 0),
	SHELL_ENTITY_IND nvarchar(1),
	EU_CTPY_IND nvarchar(1),
	CPTY_CREDIT_LIMIT_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_STOP_AMT nvarchar(MAX),
	CPTY_CREDIT_LIMIT_CER_AMT nvarchar(MAX),
	CPTY_PARENT_TXT nvarchar(500),
	CSA_IND nvarchar(1),
	CPTY_NFC_IND nvarchar(64),
	CORP_SECTOR nvarchar(25),
	INTRAGROUP_IND nvarchar(1),
	COUNTRY_CODE nvarchar(32),
	UK_CTPY_IND nvarchar(1),
	EXEMPT_IND nvarchar(1),
	BROKER_TYPE nvarchar(64),
	PRIMARY KEY (PAR_SEQ_NUM)
	);

INSERT INTO MCC_PARTY_control(PAR_SEQ_NUM, SRCE_SYSTEM_CODE, SRCE_SYSTEM_KEY, SHORT_NAME_TXT, LONG_NAME_TXT, PHONE_TXT, FAX_TXT, CREATED_BY_USERID, CREATED_TSTMP, LAST_UPDATE_USERID,
	LAST_UPDATE_TSTMP, SECURITY_TYPE_TXT, MASTERAGREEMENT_TYPE_TXT, MASTERAGREEMENT_DATE_TXT, NETTING_AGREEMENT_IND, SAP_VENDOR_CODE, AFFILIATE_COMP_IND, BROKER_IND,
	AUTH_SEQ_NUM, SHELL_ENTITY_IND, EU_CTPY_IND, CPTY_CREDIT_LIMIT_AMT, CPTY_CREDIT_LIMIT_STOP_AMT, CPTY_CREDIT_LIMIT_CER_AMT, CPTY_PARENT_TXT, CSA_IND, CPTY_NFC_IND,
	CORP_SECTOR, INTRAGROUP_IND, COUNTRY_CODE, UK_CTPY_IND, EXEMPT_IND, BROKER_TYPE)
select PAR_SEQ_NUM, SRCE_SYSTEM_CODE, SRCE_SYSTEM_KEY, SHORT_NAME_TXT, LONG_NAME_TXT, PHONE_TXT, FAX_TXT, CREATED_BY_USERID, CREATED_TSTMP, LAST_UPDATE_USERID,
	LAST_UPDATE_TSTMP, SECURITY_TYPE_TXT, MASTERAGREEMENT_TYPE_TXT, MASTERAGREEMENT_DATE_TXT, NETTING_AGREEMENT_IND, SAP_VENDOR_CODE, AFFILIATE_COMP_IND, BROKER_IND,
	AUTH_SEQ_NUM, SHELL_ENTITY_IND, EU_CTPY_IND, CPTY_CREDIT_LIMIT_AMT, CPTY_CREDIT_LIMIT_STOP_AMT, CPTY_CREDIT_LIMIT_CER_AMT, CPTY_PARENT_TXT, CSA_IND, CPTY_NFC_IND,
	CORP_SECTOR, INTRAGROUP_IND, COUNTRY_CODE, UK_CTPY_IND, EXEMPT_IND, BROKER_TYPE from 
	(select * from MCC_PARTY_delta where LAST_UPDATE_TSTMP > '2022-07-29 09:32:00') as t2

select * from MCC_PARTY_control

select * from Dummy_Oracle where latest_date > '2022-07-25 13:47:12'

select * from MCC_PARTY where LAST_UPDATE_TSTMP > '2022-07-29 09:32:00'

select * from MCC_PARTY where LAST_UPDATE_TSTMP > DATEADD(MINUTE, -15, CURRENT_TIMESTAMP)

select * from MCC_PARTY

SELECT DATEADD(MINUTE, -15, CURRENT_TIMESTAMP)

select CURRENT_TIMESTAMP 



-- Trigger checks

select * from MCC_PARTY

select count(*) from dbo.MCC_PARTY

select count(distinct PAR_SEQ_NUM) from dbo.MCC_PARTY

select * from MCC_PARTY order by LAST_UPDATE_TSTMP desc
select * from MCC_PARTY order by CREATED_TSTMP desc

delete from MCC_PARTY_delta

select top 100 * from MCC_CONTRACT where LAST_UPDATE_TSTMP > '2022-08-15 10:00:00'

select top 100 * from MCC_CONTRACT where CREATED_TSTMP > '2022-08-15 10:00:00'

select * from MCC_CONTRACT

CREATE TABLE MCC_STP_CASE_AUDIT (
    CASE_AUDIT_SEQ_NUM decimal(9,0) NOT NULL,
	SC_SEQ_NUM decimal(9,0) NOT NULL,
	CURRENT_CASE_NUM decimal(15,0) NOT NULL,
	WORKITEM_TAG nvarchar(500) NOT NULL,
	PROCEDURE_NAME_TXT nvarchar(500) NOT NULL,
	STEP_NAME_TXT nvarchar(500) NOT NULL,
	STEP_DESC_TXT nvarchar(500) NOT NULL,
	STEP_START_TSTMP datetime NULL,
	STEP_RELEASE_TSTMP datetime NULL,
	AUTO_IND nvarchar(500) NOT NULL,
	AUTO_SUCCESS_IND nvarchar(500) NOT NULL,
	STEP_UNDO_IND nvarchar(500) NOT NULL,
	GUI_DISPLAY_IND nvarchar(500) NOT NULL,
	NOTE_SEQ_NUM decimal(9, 0) NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	MATCH_STATUS_CODE nvarchar(500) NULL,
	NEXT_ACTION_TXT nvarchar(500) NULL,
	PRIMARY KEY (CASE_AUDIT_SEQ_NUM)
	);

	select * from MCC_STP_CASE_AUDIT

select count(distinct CASE_AUDIT_SEQ_NUM) from dbo.MCC_STP_CASE_AUDIT

select * from MCC_STP_CASE_AUDIT order by LAST_UPDATE_TSTMP desc

select count(*) from MCC_STP_CASE_AUDIT where CREATED_TSTMP > '2022-08-18 16:15:00'

select * from MCC_STP_CASE_AUDIT where CREATED_TSTMP > '2022-08-18 17:45:00' and CREATED_TSTMP < '2022-08-18 17:47:55' order by CREATED_TSTMP desc

select * from MCC_STP_CASE_AUDIT order by LAST_UPDATE_TSTMP desc

select * from MCC_STP_CASE_AUDIT where LAST_UPDATE_TSTMP > CREATED_TSTMP AND LAST_UPDATE_TSTMP > '2022-08-19 09:56:00' order by LAST_UPDATE_TSTMP desc

select top 10000 * from MCC_CONTRACT order by EXTERNAL_LENTITY_SEQ_NUM

select count(CON_SEQ_NUM) FROM MCC_CONTRACT

select * from MCC_CONTRACT where LAST_UPDATE_TSTMP > CREATED_TSTMP AND LAST_UPDATE_TSTMP > '2022-08-19 11:00:00' order by LAST_UPDATE_TSTMP desc

select * from MCC_CONTRACT order by LAST_UPDATE_TSTMP desc

SELECT column_name
  FROM INFORMATION_SCHEMA.COLUMNS
  WHERE table_name = 'MCC_PARTY' and ordinal_position < 2
  ORDER BY ordinal_position

select * from MCC_PARTY order by LAST_UPDATE_TSTMP desc

select * from MCC_UNIT order by LAST_UPDATE_TSTMP desc

select  count(*) from MCC_COMMITMENT
select  top 100 * from MCC_COMMITMENT

select * from MCC_QUEUE

select * from MCC_PERSONNEL

select * from CCM_DOC_FOLDER

CREATE TABLE MCC_STP_CASE (
    SC_SEQ_NUM decimal(9,0) NOT NULL,
    APPLICATION_CODE NVARCHAR(500) NOT NULL,  
    ENTITY_TYPE_CODE NVARCHAR(500) NOT NULL,   
	MAIN_CASE_NUM decimal(15,0) NOT NULL,    
	ENTITY_SEQ_NUM decimal(9,0) NOT NULL,   
	STATUS_IND NVARCHAR(500) NOT NULL,    
	SWF_SEQ_NUM decimal(9,0) NULL,    
	NOTE_SEQ_NUM decimal(9,0) NULL,    
	CLOSED_TSTMP datetime NULL,    
	CLOSED_USERID NVARCHAR(500) NULL,    
	CREATED_USERID NVARCHAR(500) NOT NULL,    
	CREATED_TSTMP datetime NOT NULL,    
	LAST_UPDATE_USERID NVARCHAR(500) NOT NULL,    
	LAST_UPDATE_TSTMP datetime NOT NULL,    
	DOC_SEQ_NUM decimal(9,0) NULL,    
	FAX_DOC_SEQ_NUM decimal(9,0) NULL,    
	XLS_DOC_SEQ_NUM decimal(9,0) NULL,    
	PREV_WF_CLOSED_TSTMP datetime NULL,
	PRIMARY KEY (SC_SEQ_NUM)
	);

select top 100 * from MCC_STP_CASE

select top 100 * from MCC_STP_CASE_AUDIT

drop table if exists MCC_STP_PROCESS_INSTANCE

CREATE TABLE MCC_STP_PROCESS_INSTANCE (
    SPI_SEQ_NUM decimal(9,0) NOT NULL,
	ACTION_TXT NVARCHAR(1000) NULL,
	KEY_TXT NVARCHAR(1000) NULL,
	STATUS_IND NVARCHAR(500) NOT NULL,
	ERROR_COUNT_NUM decimal(9,0) NULL,
	ERROR_TXT NVARCHAR(3000) NULL,
	CREATED_USERID NVARCHAR(500) NULL,
	CREATED_TSTMP datetime NULL,
	LAST_UPDATE_USERID NVARCHAR(500) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	SRCE_SYSTEM_CODE NVARCHAR(500) NULL,
	SRCE_SYSTEM_KEY NVARCHAR(500) NULL,
	CON_SEQ_NUM decimal(16,0) NULL,
	MESSAGE_RECEIVED_TSTMP datetime NULL,
	EXTERNAL_SEQ_NUM decimal(9,0) NULL,
	BATCH_ID NVARCHAR(500) NULL,
	REPORTED_ACTION_IND NVARCHAR(500) NULL,
	PRIMARY KEY (SPI_SEQ_NUM)
	);



select count(*) from MCC_STP_PROCESS_INSTANCE

select top 10 * from MCC_STP_PROCESS_INSTANCE

select top 100 * from MCC_COMMITMENT order by LAST_UPDATE_TSTMP desc

select count(*) from MCC_COMMITMENT

alter table MCC_COMMITMENT
add PRICE_TERM_RESET_CONV NVARCHAR(1000);

select top 100 * from MCC_CONTRACT

ALTER TABLE MCC_CONTRACT ALTER COLUMN INTERNAL_COMMENT_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN SRCE_SYSTEM_CODE nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	SRCE_SYSTEM_KEY nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BUY_SELL_CODE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CONTRACT_TYPE_CODE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CONTRACT_SUBTYPE_CODE nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CONTRACT_GROUP_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TOTAL_QTY_AMT nvarchar(MAX)  
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TOTAL_QTY_UNIT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	OPTION_TYPE nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BROKER_FEE_AMT nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	INTERNAL_COMMENT_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	STATUS_IND nvarchar(Max)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	LAW_TYPE_CODE nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	LAW_GOVERNING_TXT nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	DEAL_TERM_TXT nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CONTRACT_WRITER_T nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CUSTOM_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	HMS_KEY_TXT nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CONTRACT_REVISION_TXT nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CLEARING_CENTER_TXT nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	AVERAGE_PRICE nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	AVERAGE_VOLUME nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BOOK_TXT nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BROKER_STATUS_CODE nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CONFIRM_TYPE_CODE nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	COUNTERPARTY_STATUS_CODE nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	DISPUTE_IND nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	ELECTRONIC_MATCH_TXT nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	FORMATTED_XML nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	NOTIFICATION_CODE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PREMIUM_PERIOD_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PROD_CONS_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	SHELL_DOCUMENT_IND nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	SPECIAL_CONDITIONS_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TOTAL_VALUE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TRADE_STAMPS_TXT nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TRAN_NUM_ID nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	LEGACY_SRCE_SYSTEM_KEY nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	LEGACY_SRCE_SYSTEM_CODE nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	FULL_HISTORY_IND nvarchar(MAX)   
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CPARTY_STATUS_UPDATE_USERID nvarchar(MAX)    
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BROKER_STATUS_UPDATE_USERID nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CPTY_REF_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BROKER_REF_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	OTHER_TRADER_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	GOVERNING_TERM_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	INT_TRADING_STRATEGY_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CP_TRADING_STRATEGY_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PRICING_MODEL_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	INTERNAL_TRADE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	UTI_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	NOVATION_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	INTERCONNECT_POINT_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	HEDGE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	COLLATERAL_PORTFOLIO_CODE_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	EMIR_REPORTABLE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	EFET_TRANSACTION_TYPE nvarchar(MAX)  
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TRADE_CONFIRMATION_STATUS nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	MTF_CLASSIFICATION_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	ORIG_CONTRACT_SUBTYPE_CODE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	DISPUTE_RESOLUTION_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	SERVICE_LEVEL_AGREE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	LIABILITY_INDEMNITY_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PURCHASE_SIDE_NOTE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	BOOK_TYPE_CODE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	REMIT_REPORTING_CODE nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	UTI_GENERATOR_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	CPTY_UTI_PENDING_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	IMBALANCE_SETTLEMENT_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	IMBALANCE_SETTLEMENT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	STATEMENT_OF_RECORD_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PRE_DELIVERY_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PRE_DELIVERY_TERMS_TXT nvarchar(MAX)
ALTER TABLE MCC_CONTRACT ALTER COLUMN	FACILITY_NAME_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	PIPELINE_NAME_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	ECONFIRM_PRODUCT_ID nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	FEDERAL_LEASE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	DF_REPORTABLE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	REGULATORILY_CONTINUING_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	REMIT_REPORTABLE_IND nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	EXTERNAL_COMMENT_TXT nvarchar(MAX) 
ALTER TABLE MCC_CONTRACT ALTER COLUMN	TRADE_FEE_DESC nvarchar(MAX) -- run this line next

select count(*) from MCC_CONTRACT

CREATE TABLE MCC_STP_MASTER_AGREEMENT (
    SMA_SEQ_NUM decimal(9,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(500) NOT NULL,
	SHORT_NAME_TXT nvarchar(500) NOT NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL
	);

ALTER TABLE MCC_STP_MASTER_AGREEMENT
ADD PRIMARY KEY (SMA_SEQ_NUM);

CREATE TABLE CCM_ECONFIRM_TRADE_DETAIL (
    ETD_SEQ_NUM decimal(9,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(500) NOT NULL,
	UTI nvarchar(500) NOT NULL,
	SHAPED_GROUP_ID nvarchar(500) NULL,
	SHAPED_SEQ_NUM decimal(9,0) NOT NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL
	);

ALTER TABLE CCM_ECONFIRM_TRADE_DETAIL
ADD PRIMARY KEY (ETD_SEQ_NUM);

ALTER TABLE CCM_ECONFIRM_TRADE_DETAIL ALTER COLUMN UTI nvarchar(500) NULL

select * from CCM_ECONFIRM_TRADE_DETAIL

CREATE TABLE CCM_ECONFIRM_REPORT (
    REP_UNION_NUM nvarchar(500) NOT NULL,
	TRDG_COMP_MNEM nvarchar(500) NOT NULL,
	CONTRACT_NUM nvarchar(500) NOT NULL,
	PRCL_SEQ_NUM nvarchar(500) NULL,
	STRUCK_DATE datetime NULL,
	DEAL_CLASS_CODE nvarchar(500) NULL,
	OWNER_COMPANY_MNEM nvarchar(500) NULL,
	CLIENT_COMPANY_MNEM nvarchar(500) NULL,
	STATUS_CODE nvarchar(500) NULL,
	CHARGE_ACCT_MNEM nvarchar(500) NULL,
	EMIR_REPORTABLE_IND nvarchar(500) NOT NULL,
	RISK_MARKETING_IND nvarchar(500) NOT NULL,
	INTERGROUP_IND nvarchar(500) NOT NULL,
	CREATED_BY_USERID nvarchar(500) NULL,
	CREATED_TSTMP datetime NULL,
	DEAL_ENTRY_DATE datetime NULL
	);

select count(*) from CCM_ECONFIRM_REPORT
select top 10 * from CCM_ECONFIRM_REPORT

select count(distinct PRCL_SEQ_NUM) from CCM_ECONFIRM_REPORT 
select count(PRCL_SEQ_NUM) from CCM_ECONFIRM_REPORT 

select count(distinct DEAL_ENTRY_DATE) from CCM_ECONFIRM_REPORT 
select count(DEAL_ENTRY_DATE) from CCM_ECONFIRM_REPORT 

CREATE TABLE STP_ECONFIRM_OPEN_TRADE (
    SEOT_SEQ_NUM decimal(9,0) NOT NULL,
	TRADE_DATE datetime NULL,
	END_DATE datetime NULL,
	UTI_TXT nvarchar(500) NULL,
	LAST_ICE_READ_TSTMP datetime NULL,
	TRIOPTIMA_COL_UPDATE_STATUS nvarchar(500) NULL,
	ICE_OTHER_CP_TXT nvarchar(500) NULL,
	TRADING_LEGAL_ENTITY nvarchar(500) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(500) NOT NULL,
	ICE_CP_TXT nvarchar(500) NOT NULL,
	BUYER_TXT nvarchar(500) NULL,
	SELLER_TXT nvarchar(500) NULL,
	RMK_AFF_FLAG nvarchar(500) NULL,
	BUY_SELL_IND nvarchar(500) NULL,
	STATUS_IND nvarchar(500) NULL,
	TRADE_XML nvarchar(MAX) NULL,
	ERROR_TXT nvarchar(MAX) NULL,
	CREATED_TSTMP datetime NULL,
	CREATED_BY_USERID nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	PRIMARY KEY (SEOT_SEQ_NUM)
	);

ALTER TABLE STP_ECONFIRM_OPEN_TRADE ALTER COLUMN LAST_UPDATE_USERID nvarchar(500)

select count(*) from STP_ECONFIRM_OPEN_TRADE

select top 10 * from MCC_

CREATE TABLE MCC_DISPUTE (
    SD_SEQ_NUM decimal(9,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	CONTRACT_TYPE_CODE nvarchar(500) NOT NULL,
	DISPUTE_ITEM_TXT nvarchar(500) NOT NULL,
	TEMPLATE_SEQ_NUM decimal(9,0) NULL,
	LEGAL_IND nvarchar(500) NOT NULL,
	SOX_IND nvarchar(500) NOT NULL,
	OTHER_IND nvarchar(500) NOT NULL,
	DISPUTE_PARTY nvarchar(500) NOT NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	PRIMARY KEY (SD_SEQ_NUM)
	);

select * from MCC_DISPUTE

CREATE TABLE MCC_CONTRACT_DISPUTE (
    SCD_SEQ_NUM decimal(9,0) NOT NULL,
	TYPE nvarchar(500) NULL,
	DISPUTE_TO_ROLE_TXT nvarchar(500) NULL,
	DISPUTE_CREATED_ROLE_TXT nvarchar(500) NULL,
	ACTIVE_IND nvarchar(500) NULL,
	CON_SEQ_NUM decimal(9,0) NOT NULL,
	SD_SEQ_NUM decimal(9,0) NOT NULL,
	RESOLVED_IND nvarchar(500) NOT NULL,
	RESOLVED_CASE_AUDIT_SEQ_NUM decimal(9,0) NULL,
	RESOLVED_USERID nvarchar(500) NULL,
	RESOLVED_TSTMP datetime NULL,
	NOTE_TXT nvarchar(MAX) NULL,
	CREATED_CASE_AUDIT_SEQ_NUM decimal(9,0) NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	PRIMARY KEY (SCD_SEQ_NUM)
	);

select * from MCC_CONTRACT_DISPUTE

CREATE TABLE CCM_DOC_CATEGORY (
    SEQUENCE_NUM decimal(10,0) NOT NULL,
	DOC_CAT_DESC_TXT nvarchar(500) NOT NULL,
	OWNG_FOLD_SEQ_NUM decimal(10,0) NOT NULL,
	ORD_SEQ_NUM decimal(10,0) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	NOTIFICATION_IND nvarchar(500) NULL,
	ALLOW_DISPATCH_IND nvarchar(500) NULL,
	PRIMARY KEY (SEQUENCE_NUM)
	);

select * from CCM_DOC_CATEGORY

CREATE TABLE DOC_DOCUMENT (
    DOC_KEY decimal(10,0) NOT NULL,
	ESIGN_IND nvarchar(500) NOT NULL,
	DOC_CONTENT binary NULL,
	DOC_FILE_NAME_TXT nvarchar(500) NOT NULL,
	FILE_EXT_TXT nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	TEMPLATE_SEQ_NUM decimal(9,0) NULL,
	FED_SRC_TXT nvarchar(500) NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	MAIL_SUBJECT_TXT nvarchar(MAX) NULL,
	MAIL_FROM_TXT nvarchar(MAX) NULL,
	MAIL_RECEIVED_DATE datetime NULL,
	PRIMARY KEY (DOC_KEY)
	);

alter table DOC_DOCUMENT
drop column DOC_CONTENT

CREATE TABLE CCM_DOC_DEX_XREF (
    DOC_SEQ_NUM decimal(10,0) NOT NULL,
	CTMT_SEQ_NUM nvarchar(500) NULL,
	TRDG_COMP_MNEM nvarchar(500) NOT NULL,
	CONTRACT_NUM nvarchar(500) NOT NULL,
	PRCL_SEQ_NUM nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	VOYAGE_SEQ_NUM decimal(9,0) NULL,
	SHARED_IND nvarchar(500) NULL,
	PUBLISH_EXT_IND nvarchar(500) NULL,
	FED_DOC_TYPE_SEQ_NUM decimal(10,0) NULL,
	SHARED_XDECLARS_IND nvarchar(500) NULL,
	CONTRACT_CREATE_D datetime NOT NULL,
	PRIMARY KEY (DOC_SEQ_NUM)
	);

CREATE TABLE MCC_STP_COMP_REPORTABLE_ENTITY (
    SCRE_SEQ_NUM decimal(10,0) NOT NULL,
	CPTY_ENTITY_TXT nvarchar(500) NULL,
	RMK_AFFILIATE_FLAG nvarchar(500) NULL,
	CREATED_USERID nvarchar(500) NULL,
	CREATED_TSTMP datetime NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	REPORTING_CODE nvarchar(500) NULL,
	PARTY_SEQ_NUM decimal(10,0) NULL,
	ACTIVE_IND nvarchar(500) NULL,
	UTI_GENERATOR_TXT nvarchar(500) NULL,
	STANDARD_IND nvarchar(500) NULL,
	NON_STANDARD_IND datetime NULL,
	PRIMARY KEY (SCRE_SEQ_NUM)
	);

alter table MCC_STP_COMP_REPORTABLE_ENTITY
alter column NON_STANDARD_IND nvarchar(500)

CREATE TABLE MCC_STP_IFACE_STAGING (
    SIQ_SEQ_NUM decimal(10,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(500) NOT NULL,
	STATUS_IND nvarchar(500) NOT NULL,
	ACTION_IND nvarchar(500) NULL,
	ERROR_PROCESSING_COUNT_NUM decimal(10,0) NULL,
	CREATED_BY_USERID nvarchar(500) NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	TRANSACTION_TYPE nvarchar(500) NULL,
	PRIMARY KEY (SIQ_SEQ_NUM)
	);

select count(*) from DOC_DOCUMENT

CREATE TABLE MCC_STP_WORKFLOW (
    SWF_SEQ_NUM decimal(10,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	WORKFLOW_NAME_TXT nvarchar(500) NOT NULL,
	PROCEDURE_NAME nvarchar(500) NULL,
	IMPLEMENTATION_CLASS_TXT nvarchar(500) NULL,
	WORKFLOW_ACTION_IND nvarchar(500) NOT NULL,
	CREATED_USERID nvarchar(500) NULL,
	CREATED_TSTMP datetime NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	WORKFLOW_NUM decimal(10,0) NULL,
	PRIMARY KEY (SWF_SEQ_NUM)
	);


select top 100 * from MCC_STP_COMP_REPORTABLE_ENTITY

select * from MCC_STP_KPI_CREPO

CREATE TABLE MCC_STP_KPI_CREPORT (
    MAIN_CASE_NUM decimal(20,0) NOT NULL,
	CC_REVIEW_DAYS decimal(20,0) NULL,
	CC_REVIEW_START_DATE datetime NULL,
	CC_REVIEW_END_DATE datetime NULL,
	CC_REVIEW_USER nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	SOURCE_SYSTEM_CODE nvarchar(500) NULL,
	REQUEST_TYPE nvarchar(500) NULL,
	TRADEID nvarchar(500) NULL,
	COUNTERPARTY nvarchar(500) NULL,
	[QUEUE] nvarchar(500) NULL,
	NEW_OR_AMEND nvarchar(500) NULL,
	TRADEDATE datetime NULL,
	WORKFLOW nvarchar(500) NULL,
	BUY_OR_SELL nvarchar(500) NULL,
	INTERNALENTITY nvarchar(500) NULL,
	COMMODITY nvarchar(500) NULL,
	WORKFLOW_START_DATE datetime NULL,
	BROKER_CONFIRM_DAYS decimal(20,0) NULL,
	EMATCH_BROKER_STATUS nvarchar(500) NULL,
	EMATCH_CP_STATUS nvarchar(500) NULL,
	BROKER_CONF_START_DATE datetime NULL,
	BROKER_CONF_END_DATE datetime NULL,
	BROKER_CONFIRM_USER nvarchar(500) NULL,
	GENERATE_CONTRACT_DAYS decimal(20,0) NULL,
	GEN_CONTRACT_START_DATE datetime NULL,
	GEN_CONTRACT_END_DATE datetime NULL,
	GENERATE_CONTRACT_USER nvarchar(500) NULL,
	GENSEND_RESPONSE_DAYS decimal(20,0) NULL,
	RESPONSE_START_DATE datetime NULL,
	RESPONSE_END_DATE datetime NULL,
	RESPONSE_USER nvarchar(500) NULL,
	TRDDATE_TO_CPCONTRCVD_DAYS decimal(20,0) NULL,
	TRADE_TO_CCR_START_DATE datetime NULL,
	TRADE_TO_CCR_END_DATE datetime NULL,
	CPCONTRCVD_TO_WTCPCONTREL_DAYS decimal(20,0) NULL,
	CCR_TO_WCCR_START_DATE datetime NULL,
	CCR_TO_WCCR_END_DATE datetime NULL,
	WTCPCONTREL_USER nvarchar(500) NULL,
	CA_REVIEW_DAYS decimal(20,0) NULL,
	CA_REVIEW_START_DATE datetime NULL,
	CA_REVIEW_END_DATE datetime NULL,
	CA_REVIEWED_USER nvarchar(500) NULL,
	CC_SENT_DAYS decimal(20,0) NULL,
	CC_SENT_START_DATE datetime NULL,
	CC_SENT_END_DATE datetime NULL,
	CC_SENT_USER nvarchar(500) NULL,
	WKFLOW_TO_DSP_START_DATE datetime NULL,
	WKFLOW_TO_DSP_END_DATE datetime NULL,
	E2E_DAYS decimal(20,0) NULL,
	TR_REVIEW_DAYS decimal(20,0) NULL,
	TR_REVIEWED_USER nvarchar(500) NULL,
	TR_REVIEW_START_DATE datetime NULL,
	TR_REVIEW_END_DATE datetime NULL,
	PRIMARY KEY (MAIN_CASE_NUM)
	);

select top 100 * from CCM_DOC_DOCUMENT

select count(*) from CCM_DOC_XREF
select count(*) from CCM_DOC_DEX_XREF

select count(*) from STP_ECONFIRM_OPEN_TRADE
select count(*) from MCC_PARTY

select count(*) from MCC_PARTY
select count(*) from PARTY

drop table PARTY

select top 100 * from KPI_WONA_STAGE1

select top 100 * from PTC_NA_STAGE_1

-- view code for dbo.PTC_WONA_STAGE_1

SELECT        'DEX' AS SRCE_SYSTEM_CODE, { fn CONCAT(CO.TRDG_COMP_MNEM, CO.CONTRACT_NUM) } AS TRADE_ID, CO.DEAL_CLASS_CODE AS DEAL_CLASS, CO.SPOT_TERM_CODE AS DEAL_TERM_TXT, 
                         CO.CONTRACT_DATE AS TRADE_DATE, CO.LAST_PRCL_SEQ_NUM AS LAST_PARCEL, CO.TRADER_USERID AS TRADER, CO.LAST_UPDATE_TSTMP, 'M' AS CONFIRM_TYPE_CODE, 
                         CO.DOCUMENTED_BY_CODE AS DOCUMENTING_PARTY, CO.VLDT_LEVEL, CO.DOC_AGREED_IND AS AGREED, CO.DOC_AGREED_USERID AS AGREED_BY_USER, CO.VALIDATED_IND AS VALIDATED, 
                         CO.DOC_AGREED_TSTMP AS AGREED_TIMESTAMP, CO.DOC_ACKNOW_IND AS ACKNOWLEDGED, CO.DOC_ACKNOW_TSTMP AS ACKNOWLEDGED_TIMESTAMP, CO.DOC_ACKNOW_USERID AS ACKNOWLEDGED_BY_USER, 
                         CO.TDL_EXCLUDE_CODE AS EXCLUDED_REASON, CO.TDL_EXCLUDE_IND AS EXCLUDED, CO.TDL_EXCLUDE_TSTMP AS EXCLUDED_TIMESTAMP, CO.TDL_EXCLUDE_USERID AS EXCLUDED_BY_USER, 
                         CO.DISPUTE_IND AS DISPUTED, CO.DISPUTE_TSTMP AS DISPUTE_TIMESTAMP, CO.DISPUTE_USERID AS DISPUTED_BY_USER, DIS.DISPUTE_CODE, DIS.DISPUTE_TEXT, TRA.CORPORATE_ENTITY_C AS STN, 
                         ENT.GTN_MEMBER_IND, ENT.EXP_CLUB_MEM_IND, OCA.CHARGE_ACCT_MNEM AS QUEUE_NAME, CCA.CHARGE_ACCT_MNEM AS CLIENT, CCA.CHRG_ACCT_TYP_CODE, COP.COMPANY_TYPE_CODE, 
                         EVT1.STATUS_CODE AS DISPATCHED_IND, EVT1.EVENT_UPDATE_TSTMP AS DISP_TSTMP, SUM(CST.LATEST_COST_VALUE) AS OIL_COST
FROM            dbo.DEX_CONTRACT AS CO LEFT OUTER JOIN
                         dbo.DEX_CHRGACCT AS OCA ON OCA.TRDG_COMP_MNEM = CO.TRDG_COMP_MNEM AND OCA.SEQUENCE_NUM = CO.OWNG_CHRG_ACCT_NUM LEFT OUTER JOIN
                         dbo.DEX_CHRGACCT AS CCA ON CCA.TRDG_COMP_MNEM = CO.TRDG_COMP_MNEM AND CCA.SEQUENCE_NUM = CO.CLT_CHRG_ACCT_NUM LEFT OUTER JOIN
                         dbo.DEX_TRDGACCT AS TRA ON TRA.TRDG_COMP_MNEM = CO.TRDG_COMP_MNEM AND TRA.SEQUENCE_NUM = CO.OWNG_CHRG_ACCT_NUM LEFT OUTER JOIN
                         dbo.DEX_CNCHEVNT AS EVT1 ON EVT1.TRDG_COMP_MNEM = CO.TRDG_COMP_MNEM AND EVT1.CONTRACT_NUM = CO.CONTRACT_NUM AND EVT1.EVENT_CODE = 'CNTDESP' AND 
                         EVT1.EVENT_TYPE_CODE = 'ACKNOWA' LEFT OUTER JOIN
                         dbo.DEX_CORPENT AS ENT ON ENT.CORPORATE_ENTITY_C = TRA.CORPORATE_ENTITY_C LEFT OUTER JOIN
                         dbo.DEX_COMPANY AS COP ON COP.COMPANY_MNEM = CCA.COMPANY_MNEM LEFT OUTER JOIN
                         dbo.DEX_PRCLCST AS CST ON CST.TRDG_COMP_MNEM = CO.TRDG_COMP_MNEM AND CST.CONTRACT_NUM = CO.CONTRACT_NUM AND CST.CONTRACT_CREATE_D = CO.CONTRACT_CREATE_D LEFT OUTER JOIN
                         dbo.DEX_CONDISPT AS DIS ON DIS.TRADING_SYSTEM_MN = CO.TRDG_COMP_MNEM AND DIS.CONTRACT_NUM = CO.CONTRACT_NUM AND DIS.CONTRACT_CREATE_D = CO.CONTRACT_CREATE_D
WHERE        (CO.CONTRACT_DATE >= '01-JAN-20') AND (CO.DEAL_CLASS_CODE IN ('WET', 'FWD')) AND (CST.COST_CODE = 'OIL') AND (CST.COST_TYPE_CODE = 'OIL')
GROUP BY CO.TRDG_COMP_MNEM, CO.CONTRACT_NUM, CO.DEAL_CLASS_CODE, CO.SPOT_TERM_CODE, CO.CONTRACT_DATE, CO.LAST_PRCL_SEQ_NUM, CO.TRADER_USERID, CO.LAST_UPDATE_TSTMP, 
                         CO.DOCUMENTED_BY_CODE, CO.VLDT_LEVEL, CO.DOC_AGREED_IND, CO.DOC_AGREED_USERID, CO.VALIDATED_IND, CO.DOC_AGREED_TSTMP, CO.DOC_ACKNOW_IND, CO.DOC_ACKNOW_TSTMP, 
                         CO.DOC_ACKNOW_USERID, CO.TDL_EXCLUDE_CODE, CO.TDL_EXCLUDE_IND, CO.TDL_EXCLUDE_TSTMP, CO.TDL_EXCLUDE_USERID, CO.DISPUTE_IND, CO.DISPUTE_TSTMP, CO.DISPUTE_USERID, DIS.DISPUTE_CODE, 
                         DIS.DISPUTE_TEXT, TRA.CORPORATE_ENTITY_C, ENT.GTN_MEMBER_IND, ENT.EXP_CLUB_MEM_IND, OCA.CHARGE_ACCT_MNEM, CCA.CHARGE_ACCT_MNEM, CCA.CHRG_ACCT_TYP_CODE, COP.COMPANY_TYPE_CODE, 
                         EVT1.STATUS_CODE, EVT1.EVENT_UPDATE_TSTMP




CREATE TABLE DEX_CONSTOPR (
    TRADING_SYSTEM_MN nvarchar(500) NOT NULL,
	CONTRACT_NUM nvarchar(500) NOT NULL,
	CONTRACT_CREATE_D datetime NOT NULL,
	SEQ_NUM decimal(10,0) NOT NULL,
	CONTSTOP_CODE nvarchar(500) NOT NULL,
	CONTSTOP_TEXT nvarchar(500) NULL,
	INSERTED_TSTMP datetime NULL,
	INSERTED_USERID nvarchar(500) NULL,
	DELETED_IND nvarchar(500) NULL,
	LAST_RUN_TSTMP datetime NULL,
	SDW_VERSION_NUM decimal(10,0) NULL
	);
						 select count(*) from CCM_DOC_DEX_XREF
						 select top 100 * from CCM_DOC_DEX_XREF

						 select top 100 * from DEX_PRCLDCH where LAST_UPDATE_TSTMP is null
						 select count(*) from DEX_PRCLDCH
						 select count(distinct SEQUENCE_NUM) from DEX_TRDGACCT

ALTER TABLE DEX_COMPANY
ALTER COLUMN COMPANY_MNEM nvarchar(12) NOT NULL;

ALTER TABLE DEX_COMPANY
ADD PRIMARY KEY (COMPANY_MNEM);

select top 100 * from CCM_ECONFIRM_TRADE_DETAIL

select top 100 * from DEX_CONSTOPR
select count(*) from DEX_CONSTOPR

alter table DEX_CDTYCTMT
drop column C2_WKG_CALEND_IND

drop table CCM_DOC_DEX_XREF_SAMPLE

CREATE TABLE CCM_DOC_DEX_XREF_SAMPLE (
    DOC_SEQ_NUM nvarchar(500) NOT NULL,
	CTMT_SEQ_NUM nvarchar(500) NULL,
	TRDG_COMP_MNEM nvarchar(500) NOT NULL,
	CONTRACT_NUM nvarchar(500) NOT NULL,
	PRCL_SEQ_NUM nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP nvarchar(500) NOT NULL,
	VOYAGE_SEQ_NUM nvarchar(500) NULL,
	SHARED_IND nvarchar(500) NULL,
	PUBLISH_EXT_IND nvarchar(500) NULL,
	FED_DOC_TYPE_SEQ_NUM nvarchar(500) NULL,
	SHARED_XDECLARS_IND nvarchar(500) NULL,
	CONTRACT_CREATE_D nvarchar(500) NOT NULL);

select count(*) from CCM_DOC_DEX_XREF_SAMPLE
select top 100 * from CCM_DOC_DEX_XREF_SAMPLE
select top 100 * from MCC_CASE

ALTER TABLE CCM_DOC_DEX_XREF_SAMPLE
ALTER COLUMN DOC_SEQ_NUM decimal(10,0) NOT NULL;

ALTER TABLE CCM_DOC_DEX_XREF_SAMPLE
ADD LAST_UPDATE_TSTMP_NEW datetime;

UPDATE CCM_DOC_DEX_XREF_SAMPLE
set LAST_UPDATE_TSTMP_NEW = CAST(LAST_UPDATE_TSTMP as datetime)

select convert(datetime, LAST_UPDATE_TSTMP, 113) from CCM_DOC_DEX_XREF_SAMPLE

ALTER TABLE CCM_DOC_XREF
ALTER COLUMN LAST_UPDATE_TSTMP datetime NOT NULL;
 
TRUNCATE TABLE CCM_DOC_XREF

select top 100 * from MCC_DISPUTE
select top 100 * from CCM_DOC_XREF
select count(*) from CCM_DOC_XREF
select count(distinct sequence_num) from CCM_DOC_XREF

ALTER TABLE CCM_DOC_DEX_XREF
ADD PRIMARY KEY (TRDG_COMP_MNEM,CONTRACT_NUM,PRCL_SEQ_NUM,DOC_SEQ_NUM,CONTRACT_CREATE_D)

ALTER TABLE CCM_DOC_DEX_XREF
ADD CONSTRAINT PK_TEST1 PRIMARY KEY NONCLUSTERED (ID)

ALTER TABLE CCM_DOC_DEX_XREF
DROP PRIMARY KEY

select top 100 * from CCM_DOC_DEX_XREF
select count(*) from CCM_DOC_DEX_XREF
select top 100 * from DEX_PRCLDCH
select count(*) from DEX_PRCLDCH
select count(*) from DEX_PRCLDCH where LAST_UPDATE_TSTMP > '2022-09-01 00:00:00'



select top 1 * from DEX_CONSTOPR

TRUNCATE TABLE CCM_DOC_DEX_XREF

ALTER TABLE CCM_DOC_DEX_XREF
ALTER COLUMN CON_SEQ_NUM int NOT NULL;

ALTER TABLE MCC_COMMITMENT
ADD FOREIGN KEY (CON_SEQ_NUM) REFERENCES MCC_CONTRACT(CON_SEQ_NUM);

select top 100 * from MCC_COMMITMENT where CON_SEQ_NUM is null

CREATE TABLE MCC_TRADED_INSTRUMENT (
    STI_SEQ_NUM decimal(10,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(500) NOT NULL,
	SHORT_NAME_TXT nvarchar(500) NOT NULL,
	LONG_NAME_TXT nvarchar(500) NULL,
	INST_TYPE nvarchar(500) NULL,
	CREATED_BY_USERID nvarchar(500) NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	PUBLICATION_TXT nvarchar(500) NULL,
	PUBLICATION_HEADER nvarchar(500) NULL,
	CUR_SEQ_NUM decimal(10,0) NULL,
	CRUDE_PROD_IND nvarchar(500) NULL,
	DEL_POINT_KEY_ID nvarchar(500) NULL,
	DEL_POINT_LONG_NAME_TXT nvarchar(500) NULL,
	DEL_POINT_SHORT_NAME_TXT nvarchar(500) NULL,
	TRADED_INSTRUMENT_TYPE_CODE nvarchar(500) NULL,
	LEASE_SHORT_NAME_TXT nvarchar(500) NULL,
	primary key (STI_SEQ_NUM));
 
 select count(*) from MCC_TRADED_INSTRUMENT
 select count( distinct STI_SEQ_NUM) from MCC_TRADED_INSTRUMENT

 select count(*) from CCM_DOC_XREF
 select count( distinct SEQUENCE_NUM) from CCM_DOC_XREF

 CREATE TABLE MCC_CASE_DOC_XREF (
    SCDX_SEQ_NUM decimal(10,0) NOT NULL,
	DOC_SEQ_NUM decimal(10,0) NOT NULL,
	CASE_AUDIT_SEQ_NUM decimal(9,0) NOT NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	primary key (SCDX_SEQ_NUM));

select count(*) from MCC_CASE_DOC_XREF
select count( distinct SCDX_SEQ_NUM) from MCC_CASE_DOC_XREF

CREATE TABLE MCC_DOC_CONTRACT_XREF (
    DOC_SEQ_NUM decimal(10,0) NOT NULL,
	CON_SEQ_NUM decimal(9,0) NOT NULL,
	FED_DOC_TYPE_SEQ_NUM decimal(9,0) NULL,
	CREATED_USERID nvarchar(500) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL);

select count(*) from MCC_DOC_CONTRACT_XREF
select count( distinct DOC_SEQ_NUM) from MCC_DOC_CONTRACT_XREF -- dunno what the key is 

drop table DEX_GRADE

CREATE TABLE DEX_GRADE (
    GRADE_CODE nvarchar(25) NOT NULL,
	SHORT_NAME nvarchar(50) NULL,
	LONG_NAME nvarchar(50) NULL,
	GRADE_GROUP_CODE nvarchar(50) NULL,
	OIL_TYPE_CODE nvarchar(50) NULL,
	SULPHUR_VALUE_CODE nvarchar(50) NULL,
	BT_FACTOR_NUM decimal(10,0) NULL,
	LOC_SEQ_NUM decimal(10,0) NULL,
	BRENT_EQUIV_WGTN_N decimal(7,0) NULL,
	FINANCE_GRADE_GP_C nvarchar(50) NULL,
	SEASONALITY_IND nvarchar(50) NULL,
	ACTIVE_REC_IND nvarchar(50) NULL,
	MSDS_CODE nvarchar(50) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	OWNING_GRADE_CODE nvarchar(50) NULL,
	PTD_REF_CODE nvarchar(50) NULL,
	DELETED_IND nvarchar(50) NULL,
	LAST_RUN_TSTMP datetime NOT NULL,
	SDW_VERSION_NUM decimal(10,0) NOT NULL,
	primary key(GRADE_CODE));

create table DEX_NEWTRADE (
    TRADE_TSTMP nvarchar(50) NOT NULL,
	TRADE_TSTMP_TSTMP datetime NOT NULL,
	TRDG_COMP_MNEM nvarchar(50) NULL,
	CONTRACT_NUM_1 nvarchar(50) NULL,
	CONTRACT_NUM_2 nvarchar(50) NULL,
	CTMT_SEQ_NUM nvarchar(50) NULL,
	PRCL_SEQ_NUM nvarchar(50) NULL,
	PRCG_SEQ_NUM decimal(10,0) NULL,
	PRCG_TERM_SEQ_NUM decimal(5,0) NULL,
	TRIG_SEQ_NUM nvarchar(50) NULL,
	EXEC_SEQ_NUM decimal(10,0) NULL,
	TRADER_USERID nvarchar(50) NULL,
	TRADE_CODE nvarchar(50) NULL,
	DELETED_IND nvarchar(50) NULL,
	LAST_RUN_TSTMP datetime NULL,
	SDW_VERSION_NUM decimal(10,0) NULL,
	ARCHIVED_IND nvarchar(50) NULL,
	CONTRACT_CREATE_D datetime NULL,
	primary key (TRADE_TSTMP));

select count(*) from DEX_NEWTRADE

create table DEX_FUTFWDEX (
    EXEC_SEQ_NUM decimal(10,0) NOT NULL,
	TRDG_COMP_MNEM nvarchar(50) NULL,
	EXCT_CHRG_ACCT_NUM decimal(10,0) NULL,
	TRADER_USERID nvarchar(50) NULL,
	EXEC_DATE datetime NULL,
	EXEC_TIME datetime NULL,
	FILL_GENERATED_IND nvarchar(50) NULL,
	BYR_CHRG_ACCT_NUM decimal(10,0) NULL,
	BYR_CONTRACT_NUM nvarchar(50) NULL,
	BYR_CTMT_SEQ_NUM nvarchar(50) NULL,
	BBKR_CHRG_ACCT_NUM decimal(10,0) NULL,
	SLR_CHRG_ACCT_NUM decimal(10,0) NULL,
	SLR_CONTRACT_NUM nvarchar(50) NULL,
	SLR_CTMT_SEQ_NUM nvarchar(50) NULL,
	SBKR_CHRG_ACCT_NUM decimal(10,0) NULL,
	GRADE_CODE nvarchar(50) NULL,
	DEAL_CLASS_CODE nvarchar(50) NULL,
	DEAL_TYPE_RT_C nvarchar(50) NULL,
	DEAL_TYPE_CODE nvarchar(50) NULL,
	SPREAD_DIFF_VAL decimal(8,0) NULL,
	NUMBER_OF_LOTS_AMT decimal(5,0) NULL,
	TRADED_PERIOD1_C nvarchar(50) NULL,
	TRADED_PERIOD2_C nvarchar(50) NULL,
	FRML_NAME nvarchar(50) NULL,
	FRML_VERS_NUM decimal(5,0) NULL,
	FIXED_PRICE decimal(13,0) NULL,
	FIXED_PRICE_UNIT_C nvarchar(50) NULL,
	PRCG_FROM_DATE datetime NULL,
	PRCG_TO_DATE datetime NULL,
	PREMIUM_AMT decimal(13,0) NULL,
	PREMIUM_UNIT_CODE nvarchar(50) NULL,
	TRADE_TYPE_IND nvarchar(50) NULL,
	USER_NOTES1_TXT nvarchar(50) NULL,
	USER_NOTES2_TXT nvarchar(50) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	DELETED_IND nvarchar(50) NULL,
	LAST_RUN_TSTMP datetime NOT NULL,
	SDW_VERSION_NUM decimal(10,0) NOT NULL,
	ARCHIVED_IND nvarchar(50) NOT NULL,
	primary key (EXEC_SEQ_NUM, ARCHIVED_IND));

create table MCC_NOTE (
	NOTE_SEQ_NUM decimal(9,0) NOT NULL,
	NOTE_TXT nvarchar(MAX) NULL,
	NOTE_TYPE_TXT nvarchar(50) NOT NULL,
	CREATED_USERID nvarchar(100) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(100) NOT NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	primary key (NOTE_SEQ_NUM));

select top 1 * from DEX_NEWTRADE

drop table DEX_PRICING

create table DEX_PRICING (
	SEQUENCE_NUM decimal(20,0) NOT NULL,
	COMMENTS_TEXT nvarchar(MAX) NULL,
	DOC_REQUEST_CODE decimal(20,0) NULL,
	CURRENCY_CODE nvarchar(MAX) NULL,
	UNITS_CODE nvarchar(MAX) NULL,
	FIXED_PRICE decimal(20,0) NULL,
	VLDT_LEVEL nvarchar(MAX) NULL,
	PREMIUM_PRICE decimal(20,0) NULL,
	PREMIUM_CURR_CODE nvarchar(MAX) NULL,
	PREMIUM_UNIT_CODE nvarchar(MAX) NULL,
	FXD_PRC_CLG_PRC decimal(20,0) NULL,
	FXD_PRC_FLOOR_PRC decimal(20,0) NULL,
	CEILING_VOLATY_NUM decimal(20,0) NULL,
	FLOOR_VOLATY_NUM decimal(20,0) NULL,
	FINAL_PRCL_PRICE decimal(20,0) NULL,
	PRICE_USED_IND nvarchar(MAX) NULL,
	CALC_STD_PRICE decimal(20,0) NULL,
	CALC_CLG_PRICE decimal(20,0) NULL,
	CALC_FLOOR_PRICE decimal(20,0) NULL,
	ORIDE_PRICE decimal(20,0) NULL,
	TRIG_ACTION_TXT nvarchar(MAX) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	DELETED_IND nvarchar(MAX) NULL,
	LAST_RUN_TSTMP datetime NOT NULL,
	SDW_VERSION_NUM decimal(20,0) NOT NULL,
	ARCHIVED_IND nvarchar(MAX) NOT NULL,
	VALUATION_TERM_NUM decimal(20,0) NULL,
	EXTENDED_PRCG_IND nvarchar(MAX) NULL,
	ICP_DATE datetime NULL,
	NON_USD_FIXED_PRC decimal(20,0) NULL,
	NON_USD_FINAL_PRC decimal(20,0) NULL,
	NON_USD_PRC_CCY_C nvarchar(MAX) NULL,
	NON_USD_ORIDE_PRC decimal(20,0) NULL,
	NON_USD_PREM_PRC decimal(20,0) NULL,
	NON_USD_PREM_CCY_C nvarchar(MAX) NULL,
	DM_OFFSET_NUM decimal(20,0) NULL,
	DM_WKG_CALEND_IND nvarchar(MAX) NULL,
	NON_USD_FXD_CLG_PR decimal(20,0) NULL,
	NON_USD_FXD_FLR_PR decimal(20,0) NULL,
	NON_USD_CAL_CLG_PR decimal(20,0) NULL,
	NON_USD_CAL_FLR_PR decimal(20,0) NULL,
	NON_USD_PRCG_UNT_C nvarchar(MAX) NULL,
	SPREAD_OPTION_PRC decimal(20,0) NULL,
	DY_EVENT_CODE nvarchar(MAX) NULL,
	DY_OFFSET_NUM decimal(20,0) NULL,
	DY_PRDD_TYPE_CODE nvarchar(MAX) NULL,
	EXP_TERM_CHANGED_I nvarchar(MAX) NULL,
	EXTD_PRCG_TYPE_CDE nvarchar(MAX) NULL,
	CALC_DES_PRICE decimal(20,0) NULL,
	MAX_OPER_TERM_NUM decimal(20,0) NULL,
	DES_PRCG_IND nvarchar(MAX) NULL,
	CALC_NLNG_PRICE decimal(20,0) NULL,
	FL_NEG_PRC_AGRD_TY nvarchar(MAX) NULL);

select count(*) from DEX_PRICING
select top 100 * from DEX_PRICING

select top 100 * from DEX_NEWTRADE

drop table DEX_PRICING

create table DEX_PRICING (
	FL_NEG_PRC_AGRD_TY nvarchar(MAX) NULL);

select SEQUEN

create table DEX_PRCGPRDD (
	SEQUENCE_NUM decimal(10,0) NOT NULL,
	CALENDAR_CODE nvarchar(25) NULL,
	PRD_DEF_TYPE_CODE nvarchar(25) NULL,
	SEDATE_OD_CODE nvarchar(25) NULL,
	BASE_EVENT_CODE nvarchar(25) NULL,
	OFFSET_F_BEVENT_N decimal(5,0) NULL,
	BDATE_OD_CODE nvarchar(25) NULL,
	FIXED_BASE_DATE datetime NULL,
	INCL_BDATE_QUOTE_I nvarchar(25) NULL,
	STRT_DATE_OFFSET_N decimal(5,0) NULL,
	FXD_PRD_STRT_DATE datetime NULL,
	CALC_PRD_STRT_DATE datetime NULL,
	END_DATE_OFFSET_N decimal(5,0) NULL,
	FXD_PRD_END_DATE datetime NULL,
	CALC_PRD_END_DATE datetime NULL,
	WEND_USE_OTH_DAY_C nvarchar(25) NULL,
	WEND_PRD_BNDS_C nvarchar(25) NULL,
	HLDY_USE_OTH_DAY_C nvarchar(25) NULL,
	HLDY_PRD_BNDS_C nvarchar(25) NULL,
	XCL_HIGH_QUOTES_N decimal(5,0) NULL,
	XCL_LOW_QUOTES_N decimal(5,0) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	DELETED_IND nvarchar(25) NULL,
	LAST_RUN_TSTMP datetime NOT NULL,
	SDW_VERSION_NUM decimal(10,0) NOT NULL,
	ARCHIVED_IND nvarchar(25) NOT NULL,
	primary key (SEQUENCE_NUM, ARCHIVED_IND));

select count(*) from DEX_PRCGPRDD
select top 100 * from DEX_PRCGPRDD

CREATE TABLE DEX_COMPADDR (
	COMPANY_MNEM nvarchar(25) NOT NULL,
	ADDRESS_TYPE_CODE nvarchar(25) NOT NULL,
	SEQ_NUM decimal(5,0) NOT NULL,
	ADDRESS_TYPE_RT_C nvarchar(25) NULL,
	ADDRESS_NUM decimal(10,0) NULL,
	PREFERRED_IND nvarchar(25) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	DELETED_IND nvarchar(25) NULL,
	LAST_RUN_TSTMP datetime NOT NULL,
	SDW_VERSION_NUM decimal(10, 0) NOT NULL,
	PRIMARY KEY (COMPANY_MNEM, ADDRESS_TYPE_CODE, SEQ_NUM));

select count(*) from DEX_COMPADDR
select top 100 * from DEX_COMPADDR

CREATE TABLE DEX_EVNTNARR (
	SEQUENCE_NUM decimal(10,0) NOT NULL,
	NARRATIVE_TEXT nvarchar(2500) NULL,
	LAST_UPDATE_TSTMP datetime NULL,
	DELETED_IND nvarchar(25) NULL,
	LAST_RUN_TSTMP datetime NULL,
	SDW_VERSION_NUM decimal(10,0) NULL,
	ARCHIVED_IND nvarchar(25) NULL,
	PRIMARY KEY (SEQUENCE_NUM));

select count(*) from DEX_EVNTNARR
select top 100 TRADE_TSTMP_TSTMP, LAST_RUN_TSTMP, CONTRACT_CREATE_D from DEX_NEWTRADE

select * from MCC_IFACE_STAGING

truncate table MCC_STP_IFACE_STAGING

CREATE TABLE MCC_STP_IFACE_STAGING (
    SIQ_SEQ_NUM decimal(10,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(500) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(500) NOT NULL,
	STATUS_IND nvarchar(500) NOT NULL,
	MESSAGE_XML nvarchar(MAX) NULL,
	ACTION_IND nvarchar(500) NULL,
	ERROR_PROCESSING_COUNT_NUM decimal(10,0) NULL,
	CREATED_BY_USERID nvarchar(500) NULL,
	CREATED_TSTMP datetime NOT NULL,
	LAST_UPDATE_USERID nvarchar(500) NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	TRANSACTION_TYPE nvarchar(500) NULL,
	PRIMARY KEY (SIQ_SEQ_NUM)
	);

alter table MCC_IFACE_STAGING
add MESSAGE_XML nvarchar(MAX) NULL

select top 100 * from MCC_COMMITMENT

ALTER TABLE MCC_COMMITMENT ALTER COLUMN PAY_REC_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FIXED_FLOAT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_DATE_OFFSET_TYPE nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_DATE_OFFSET_EVENT nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_D_OFFSET_BEFORE_AFTER_T nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN DAILY_VOLUME_TXT nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_DESC_TXT nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_UNIT_CODE nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_TLNCE_OPTION_TXT nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_OPTION_TXT nvarchar(MAX)

ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICING_EVENT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SETTLEMENT_EVENT_DUE1_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SETTLEMENT_EVENT_DUE2_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN WORKING_CALENDAR_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PAYMENT_WHICHEVER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEMURRAGE_TERMS_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN HOLIDAY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PUT_CALL_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN AVERAGING_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAST_TRADING_DAY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN NEARBY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_UNIT_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN REF_SOURCE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN REF_SOURCE_AVERAGE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN AGREEMENT_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LOADING_CONTRACTUAL_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DISCHARGE_CONTRACTUAL_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN MARINE_DELIVERY_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CHARTER_PARTY_RATE_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PART_CARGO_PRO_RATA_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CONOCO_WEATHER_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAYTIME_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INTERNALTIONAL_DEAL_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN IMPORTER_OF_RECORD_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN EXPORTER_OF_RECORD_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN EFP_CONTRACT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN EXTERNAL_COMMENT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INTERNAL_COMMENT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CREATED_BY_USERID nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAST_UPDATE_USERID nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INSPECTION_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_TYPE_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_PERIOD_TYPE_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_METHOD_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_HOLIDAY_OFFSET_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CYCLE_START_EVENT_LABEL_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CYCLE_END_EVENT_LABEL_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CYCLE_DESCRIPTION_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SCHEDULE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_DATE_OFFSET_TYPE2 nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_WORKING_CALENDAR_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_WHICHEVER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_SPNW_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_OVERRIDE_DATE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_DATE_OFFSET_EVENT2 nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_NON_WORKING_DAY_RULE_TEXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SPECIFICATION_TYPE_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN BILLABLE_FEE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEMURRAGE_RATE_TYPE_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INSPECTOR_APPOINTED_BY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEM_TIME_BAR_FROM_AFTER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEMURRAGE_TIME_BAR_EVENT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_COMMENT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_QLTY_TIME_BAR_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN QTY_QLTY_TIME_LABEL_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_FUNCTION_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_EVENT_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_EVENT_DATE_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAYTIME_SHINC_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAYTIME_PRORATA_PART_CARGO_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PIPE_LINE_SYSTEM_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_INJECTION_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_CONTRACT_NEARBY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN ACTIVE_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN GRAVITY_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PUBLIC_DOCK_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INTL_SECURITY_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INTL_GTC_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN BILL_DATE_OFFSET_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN BILL_NON_WORKING_DAY_RULE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN BILL_PERIOD_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEL_DAYS_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FUTURES_CONTRACT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TIMEZONE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN MARKET2_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN COMPONENT2_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_CONDITIONS_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SECURITY_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_HEADER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_NUMBER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_NAME_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_COUNTY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_STATE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_OPERATOR_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_PRICE_BASIS_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_PAYMENT_TERMS_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_TAX_STATUS_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_TIERED_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN HOLD_BASICS_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DELIVERY_TERMS_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LPS_OFFSHORE_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PERIOD_VOLUME_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INDEX_LOCATION_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN RESET_PRD nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SETTLEMENT_PRD nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN VOLUME_TOLERANCE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TITLE_TRANSFER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN RISK_TRANSFER_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRO_RATE_PART_CARGO_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OPT_BARGE_OR_VESSEL_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SUBJECT_TO_VETTING_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN WINDOW_NARROWING_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN MARINE_CUSTOMS_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAYTIME_NOR_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OPT_BARGE_OR_VESSEL_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEMURRAGE_RATE_PER_DAY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_DATE_OFFSET_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FIXED_PRICE_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN EDP_PRICE_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_WEIGHT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_NAME nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_SPREAD_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_EFP_FLAG nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_UNIT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_CURRENCY nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROJ_INDEX_SOURCE_NAME nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRODUCT_GRADE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN EFP_CONTRACT_SHORT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CYCLE_START_EVENT_NAME_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CYCLE_END_EVENT_NAME_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_TIER1_RATE_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_TIER1_FORMULA nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_UOM_CONVERSION_DESC nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TAX_CREDIT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OLE_EVENT_DATE_DESCRIPTION nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OLE_EVENT_CODE_SHORT_NAME nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OLE_NGBD_WEIGHTING nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TAX_CREDIT_TERM_YEAR_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TYPE_OF_IDX_PRICE_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FIXING_IDX_TYPE_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FIXING_IDX_SRC_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FIXING_FREQUENCY_CODE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PLANNED_DELIVERY_PORT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LIFTING_DAY_OF_WEEK nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LIFTING_PERIOD_VALUE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LIFTING_PERIOD_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LIFTING_PER_PERIOD nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TOLERANCE_LEVEL nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN WATER_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DEMURRAGE_RATE_TERMS nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INSPECTOR_PAID_BY nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FREE_TRADE_AGREEMENT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DUTY_STATUS nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN FOREIGN_TRADE_ZONE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CTMT_STATUS nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CTMT_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OPTIONALITY nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN OPTIONALITY_LINK nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DESK_ID nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN COMMODITY_WINDOW_LENGTH nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN RIN_ASSIGNMENT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN RIN_GENERATOR_NAME nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LCFS_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DODD_FRANK_OPTIONALITY nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN VOLUME_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LOGISTICS_SYSTEM nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN SECONDARY_TOLERANCE_LEVEL nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN CONTRACTUAL_WINDOW_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN DISPUTE_RESOLUTION_CTMT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN ENDUR_CTMT_PARCEL_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN VESSEL_ACCEPTED_BY_ENTITY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_DT_OFFSET_FOLLOW_PRECEDE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN QAP_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PYMT_TYPE_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN TITLE_TRANSFER_FACILITY_GROUP nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN LAW_GOVERNING_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INT_BUSINESS_UNIT_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROVISIONAL_PRICING_IND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PROVISIONAL_PRICING_TYPE nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN BIOTAX_CREDIT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN BIOTAX_CREDIT_RECEIVEDBY nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN INTERNAL_STRATEGY_TXT nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN WEEKEND nvarchar(MAX)
ALTER TABLE MCC_COMMITMENT ALTER COLUMN PRICE_TERM_RESET_CONV nvarchar(MAX)

alter table DEX_PRCLDCH
add PRCLDCH_SEQ_NUM int identity(1,1)

ALTER TABLE DEX_PRCLDCH
  ADD CONSTRAINT DEX_PRCLDCH_pk 
    PRIMARY KEY (PRCLDCH_SEQ_NUM);

select top 100 * from DEX_PRCLDCH order by PRCLDCH_SEQ_NUM desc

select count(*) from DEX_PRCGPRDD
select count(distinct PRCL_SEQ_NUM) from DEX_PRCLDCH

ALTER TABLE DEX_PRCLDCH
  DROP CONSTRAINT IF EXISTS DEX_PRCLDCH_pk;

ALTER TABLE DEX_PRCLDCH
DROP COLUMN IF EXISTS PRCLDCH_SEQ_NUM;

CREATE TABLE CCM_ECONFIRM_DATA_SUBMIT (
    CEB_SEQ_NUM decimal(9,0) NOT NULL,
	SRCE_SYSTEM_CODE nvarchar(15) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(40) NOT NULL,
	ECONFIRM_BATCH_ID_NUM decimal(15,0) NOT NULL,
	CREATED_BY_USERID nvarchar(80) NULL,
	CREATED_TSTMP datetime NOt null,
	LAST_UPDATE_USERID nvarchar(80) NULL,
	LAST_UPDATE_TSTMP datetime NOT NULL,
	TRDG_COMP_MNEM nvarchar(5) NULL,
	CONTRACT_NUM nvarchar(5) NULL,
	STRUCK_DATE datetime NULL,
	ECONFIRM_STATUS nvarchar(5) NULL,
	PRCL_SEQ_NUM nvarchar(5) NULL,
	VET_IND nvarchar(5) NULL,
	PRIMARY KEY (CEB_SEQ_NUM)
	);

select count(*) from CCM_ECONFIRM_DATA_SUBMIT
select top 100 * from CCM_ECONFIRM_DATA_SUBMIT


CREATE TABLE CCM_ECONFIRM_ERROR_LOG (
    CEE_SEQ_NUM decimal(9,0) NOT NULL,
	SRCE_SYSTEM_KEY nvarchar(40) NOT NULL,
	ERR_TYPE nvarchar(300) NULL,
	ERR_DESC nvarchar(600) NULL,
	ERR_EVENT_CODE nvarchar(20) NULL,
	ERR_CODE nvarchar(300) NULL,
	ERR_STATUSDATE nvarchar(40) NULL,
	CREATED_BY_USERID nvarchar(80) NOT NULL,
	CREATED_TSTMP datetime NOT NULL,
	PRIMARY KEY (CEE_SEQ_NUM)
	);

select count(*) from CCM_ECONFIRM_ERROR_LOG
select top 100 * from CCM_ECONFIRM_ERROR_LOG order by CREATED_TSTMP desc

-- DELETING ROWS THAT HAVE BEEN DELETED IN ORACLE

CREATE TABLE DELETE_DEX_PRCLDCH (
    ARCHIVED_IND nvarchar(1) NULL,
	PRCL_SEQ_NUM nvarchar(4) NULL,
	CONTRACT_NUM nvarchar(4) NULL,
	TRDG_COMP_MNEM nvarchar(2) NULL
	);

select top 100 * from DELETE_DEX_PRCLDCH
select count(*) from DELETE_DEX_PRCLDCH
select count(*) from DEX_PRCLDCH


select distinct * from DELETE_DEX_PRCLDCH

select * from DEX_PRCLDCH where CONCAT(ARCHIVED_IND, '\', PRCL_SEQ_NUM, '\', CONTRACT_NUM, '\', TRDG_COMP_MNEM)   NOT IN (select CONCAT(ARCHIVED_IND, '\', PRCL_SEQ_NUM, '\', CONTRACT_NUM, '\', TRDG_COMP_MNEM) from DELETE_DEX_PRCLDCH)

select PRCLDCH_SEQ_NUM from DEX_PRCLDCH where CONCAT(ARCHIVED_IND, '\', PRCL_SEQ_NUM, '\', CONTRACT_NUM, '\', TRDG_COMP_MNEM)   NOT IN (select CONCAT(ARCHIVED_IND, '\', PRCL_SEQ_NUM, '\', CONTRACT_NUM, '\', TRDG_COMP_MNEM) from DELETE_DEX_PRCLDCH)

delete from DEX_PRCLDCH where PRCLDCH_SEQ_NUM IN (select PRCLDCH_SEQ_NUM from DEX_PRCLDCH where CONCAT(ARCHIVED_IND, '\', PRCL_SEQ_NUM, '\', CONTRACT_NUM, '\', TRDG_COMP_MNEM)   NOT IN (select CONCAT(ARCHIVED_IND, '\', PRCL_SEQ_NUM, '\', CONTRACT_NUM, '\', TRDG_COMP_MNEM) from DELETE_DEX_PRCLDCH))

drop table DELETE_DEX_CDTYCTMT

CREATE TABLE DELETE_DEX_CDTYCTMT (
    TRDG_COMP_MNEM nvarchar(4) NOT NULL,
	CONTRACT_NUM nvarchar(6) NOT NULL,
	CTMT_SEQ_NUM nvarchar(4) NOT NULL,
	CONTRACT_CREATE_D datetime2(0) NOT NULL
	);

select CONVERT(nvarchar, '2022-09-01 00:00:00')
select count(*) from DEX_CDTYCTMT
select count(*) from DELETE_DEX_CDTYCTMT

select * from DEX_CDTYCTMT where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM)   NOT IN (select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM) from DELETE_DEX_CDTYCTMT)

select top 100 CONVERT(nvarchar, CONTRACT_CREATE_D) from DELETE_DEX_CDTYCTMT
select  top 100 CONTRACT_CREATE_D from DELETE_DEX_CDTYCTMT

select top 100 CONVERT(nvarchar, CONTRACT_CREATE_D) from DEX_CDTYCTMT
select  top 100 CONTRACT_CREATE_D from DEX_CDTYCTMT

select CDTYCTMT_SEQ_NUM from DEX_CDTYCTMT where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', CONVERT(nvarchar, CONTRACT_CREATE_D))   NOT IN (select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', CONVERT(nvarchar, CONTRACT_CREATE_D)) from DELETE_DEX_CDTYCTMT)

delete from DEX_CDTYCTMT where CDTYCTMT_SEQ_NUM IN (select CDTYCTMT_SEQ_NUM from DEX_CDTYCTMT where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', CONVERT(nvarchar, CONTRACT_CREATE_D))   NOT IN (select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', CONVERT(nvarchar, CONTRACT_CREATE_D)) from DELETE_DEX_CDTYCTMT))

CREATE TABLE DELETE_DEX_CHRGACCT (
    SEQUENCE_NUM decimal(10,0) NOT NULL,
    TRDG_COMP_MNEM nvarchar(4) NULL
	);

select count(*) from DEX_CHRGACCT
select count(*) from DELETE_DEX_CHRGACCTz

CREATE TABLE DELETE_DEX_CNCHEVNT (
    TRDG_COMP_MNEM nvarchar(4) NULL,
	CONTRACT_NUM nvarchar(6) NULL,
	EVENT_TYPE_CODE nvarchar(10) NULL,
	EVENT_CODE nvarchar(10) NULL,
	SEQ_NUM decimal(10,0) NULL,
	CONTRACT_CREATE_D datetime2(0)
	);

select count(*) from DEX_CNCHEVNT
select count(*) from DELETE_DEX_CNCHEVNT

CREATE TABLE DELETE_DEX_COMPADDR (
    COMPANY_MNEM nvarchar(30) NOT NULL, 
	ADDRESS_TYPE_CODE nvarchar(30) NOT NULL, 
	SEQ_NUM decimal(5,0) NOT NULL
	);

select count(*) from DEX_COMPADDR
select count(*) from DELETE_DEX_COMPADDR

CREATE TABLE DELETE_DEX_CONDISPT (
    TRADING_SYSTEM_MN nvarchar(4) NULL, 
	CONTRACT_NUM nvarchar(6) NULL, 
	DISPUTE_CODE nvarchar(20) NULL, 
	CONTRACT_CREATE_D datetime2(0) NULL
	);

select count(*) from DEX_CONDISPT
select count(*) from DELETE_DEX_CONDISPT

drop table DELETE_DEX_CONSTOPR 

CREATE TABLE DELETE_DEX_CONSTOPR (
    TRADING_SYSTEM_MN nvarchar(600) NOT NULL,
	CONTRACT_NUM nvarchar(600) NOT NULL,
	CONTRACT_CREATE_D datetime NOT NULL,
	SEQ_NUM decimal(10,0) NOT NULL,
	CONTSTOP_CODE nvarchar(600) NOT NULL
	);

select count(*) from DEX_CONSTOPR
select count(*) from DELETE_DEX_CONSTOPR

CREATE TABLE DELETE_DEX_CONTRACT (
    CONTRACT_CREATE_D datetime2(0) NULL,
	ARCHIVED_IND nvarchar(2) NULL,
	CONTRACT_NUM nvarchar(6) NULL,
	TRDG_COMP_MNEM nvarchar(4) NULL
	);

select count(*) from DEX_CONTRACT
select count(*) from DELETE_DEX_CONTRACT

CREATE TABLE DELETE_DEX_FUTFWDEX (
    EXEC_SEQ_NUM decimal(10,0) NOT NULL,
	ARCHIVED_IND nvarchar(60) NOT NULL
	);

select count(*) from DEX_FUTFWDEX
select count(*) from DELETE_DEX_FUTFWDEX

CREATE TABLE DELETE_DEX_NEWTRADE (
    TRADE_TSTMP nvarchar(60) NOT NULL
	);

select count(*) from DEX_NEWTRADE
select count(*) from DELETE_DEX_NEWTRADE

alter table DEX_NEWTRADE
drop column NEWTRADE_SEQ_NUM

CREATE TABLE DELETE_DEX_PARCEL (
    TRDG_COMP_MNEM nvarchar(4) NULL,
	CONTRACT_NUM nvarchar(6) NULL,
	PRCL_SEQ_NUM nvarchar(6) NULL,
	ARCHIVED_IND nvarchar(2) NULL,
	CONTRACT_CREATE_D datetime2(0) NULL
	);

select count(*) from DEX_PARCEL
select count(*) from DELETE_DEX_PARCEL

select top 1 * from DEX_PRICING

CREATE TABLE DELETE_DEX_PRCGPRDD (
    SEQUENCE_NUM decimal(10,0) NOT NULL,
	ARCHIVED_IND nvarchar(30) NOT NULL
	);

select count(*) from DEX_PRCGPRDD
select count(*) from DELETE_DEX_PRCGPRDD

CREATE TABLE DELETE_DEX_PRCLCST (
    TRDG_COMP_MNEM nvarchar(4) NULL,
	CONTRACT_NUM nvarchar(6) NULL,
	PRCL_SEQ_NUM nvarchar(6) NULL,
	COST_TYPE_CODE nvarchar(6) NULL,
	COST_CODE nvarchar(6) NULL,
	ARCHIVED_IND nvarchar(2) NULL,
	CONTRACT_CREATE_D datetime2(0) NULL
	);

select count(*) from DEX_PRCLCST
select count(*) from DELETE_DEX_PRCLCST

CREATE TABLE DELETE_DEX_PRICING (
    SEQUENCE_NUM decimal(20,0) NOT NULL,
	ARCHIVED_IND nvarchar(MAX) NOT NULL
	);

select count(*) from DEX_PRICING
select count(*) from DELETE_DEX_PRICING
select * from DELETE_DEX_PRICING


delete from DEX_PRCLCST where PRCLCST_SEQ_NUM IN (select PRCLCST_SEQ_NUM from DEX_PRCLCST where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', PRCL_SEQ_NUM, '\', COST_TYPE_CODE, '\', COST_CODE, '\', ARCHIVED_IND, '\', CONVERT(nvarchar, CONTRACT_CREATE_D))   NOT IN (select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', PRCL_SEQ_NUM, '\', COST_TYPE_CODE, '\', COST_CODE, '\', ARCHIVED_IND, '\', CONVERT(nvarchar, CONTRACT_CREATE_D)) from DELETE_DEX_PRCLCST))

delete from DEX_PRICING where PRICING_SEQ_NUM IN (
select PRICING_SEQ_NUM from DEX_PRICING where CONCAT(SEQUENCE_NUM, '\', ARCHIVED_IND) IN (select CONCAT(SEQUENCE_NUM, '\', ARCHIVED_IND) from DELETE_DEX_PRICING)
)

delete from DEX_GRADE where GRADE_CODE IN (select GRADE_CODE from DEX_GRADE where GRADE_CODE) NOT IN (select GRADE_CODE) from DELETE_DEX_GRADE))


CREATE TABLE DELETE_DEX_TRDGACCT (
    TRDG_COMP_MNEM nvarchar(4) NULL,
	SEQUENCE_NUM decimal(10,0) NULL
	);

select count(*) from DEX_TRDGACCT
select count(*) from DELETE_DEX_TRDGACCT

CREATE TABLE DELETE_DEX_COMPANY (
    COMPANY_MNEM nvarchar(14) NOT NULL
	);

select count(*) from DEX_COMPANY
select count(*) from DELETE_DEX_COMPANY

CREATE TABLE DELETE_DEX_GRADE (
    GRADE_CODE nvarchar(27) NOT NULL
	);

select count(*) from DEX_GRADE
select count(*) from DELETE_DEX_GRADE

CREATE TABLE DELETE_DEX_CORPENT (
    CORPORATE_ENTITY_C nvarchar(10) NOT NULL
	);

select count(*) from DEX_CORPENT
select count(*) from DELETE_DEX_CORPENT

CREATE TABLE DELETE_DEX_EVNTNARR (
    SEQUENCE_NUM decimal(10,0) NOT NULL
	);

select count(*) from DEX_EVNTNARR
select count(*) from DELETE_DEX_EVNTNARR

CREATE TABLE DELETE_MCCFED_CASE (
    SC_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_CASE
select count(*) from DELETE_MCCFED_CASE

CREATE TABLE DELETE_MCCFED_CASE_AUDIT (
    CASE_AUDIT_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_CASE_AUDIT
select count(*) from DELETE_MCCFED_CASE_AUDIT

CREATE TABLE DELETE_MCCFED_CASE_DOC_XREF (
    SCDX_SEQ_NUM decimal(10,0) NOT NULL
	);

select count(*) from MCC_CASE_DOC_XREF
select count(*) from DELETE_MCCFED_CASE_DOC_XREF

CREATE TABLE DELETE_MCCFED_COMMITMENT (
    COM_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_COMMITMENT
select count(*) from DELETE_MCCFED_COMMITMENT

CREATE TABLE DELETE_MCCFED_COMP_REPORTABLE_ENTITY (
    SCRE_SEQ_NUM decimal(10,0) NOT NULL
	);

select count(*) from MCC_COMP_REPORTABLE_ENTITY
select count(*) from DELETE_MCCFED_COMP_REPORTABLE_ENTITY

CREATE TABLE DELETE_MCCFED_CONTRACT (
    CON_SEQ_NUM int NOT NULL
	);

select count(*) from MCC_CONTRACT
select count(*) from DELETE_MCCFED_CONTRACT

CREATE TABLE DELETE_MCCFED_DISPUTE (
    SD_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_DISPUTE
select count(*) from DELETE_MCCFED_DISPUTE

CREATE TABLE DELETE_MCCFED_DOC_CONTRACT_XREF (
    DOC_SEQ_NUM decimal(10,0) NOT NULL
	);

select count(*) from MCC_DOC_CONTRACT_XREF
select count(*) from DELETE_MCCFED_DOC_CONTRACT_XREF

CREATE TABLE DELETE_MCCFED_ECONFIRM_OPEN_TRADE (
    SEOT_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_ECONFIRM_OPEN_TRADE
select count(*) from DELETE_MCCFED_ECONFIRM_OPEN_TRADE

CREATE TABLE DELETE_MCCFED_KPI_CREPORT (
    MAIN_CASE_NUM decimal(20,0) NOT NULL
	);

select count(*) from MCC_KPI_CREPORT
select count(*) from DELETE_MCCFED_KPI_CREPORT

CREATE TABLE DELETE_MCCFED_MASTER_AGREEMENT (
    SMA_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_MASTER_AGREEMENT
select count(*) from DELETE_MCCFED_MASTER_AGREEMENT

CREATE TABLE DELETE_MCCFED_NOTE (
    NOTE_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_NOTE
select count(*) from DELETE_MCCFED_NOTE

CREATE TABLE DELETE_MCCFED_PARTY (
    PAR_SEQ_NUM int NOT NULL
	);

select count(*) from MCC_PARTY
select count(*) from DELETE_MCCFED_PARTY

CREATE TABLE DELETE_MCCFED_PERSONNEL (
    PER_SEQ_NUM int NOT NULL
	);

select count(*) from MCC_PERSONNEL
select count(*) from DELETE_MCCFED_PERSONNEL

CREATE TABLE DELETE_MCCFED_PROCESS_INSTANCE (
    SPI_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from MCC_PROCESS_INSTANCE
select count(*) from DELETE_MCCFED_PROCESS_INSTANCE

CREATE TABLE DELETE_MCCFED_QUEUE (
    SQ_SEQ_NUM int NOT NULL
	);

select count(*) from MCC_QUEUE
select count(*) from DELETE_MCCFED_QUEUE

CREATE TABLE DELETE_MCCFED_TRADED_INSTRUMENT (
    STI_SEQ_NUM decimal(10,0) NOT NULL
	);

select count(*) from MCC_TRADED_INSTRUMENT
select count(*) from DELETE_MCCFED_TRADED_INSTRUMENT

CREATE TABLE DELETE_MCCFED_UNIT (
    UNT_SEQ_NUM int NOT NULL
	);

select count(*) from MCC_UNIT
select count(*) from DELETE_MCCFED_UNIT

CREATE TABLE DELETE_MCCFED_WORKFLOW (
    SWF_SEQ_NUM decimal(10,0) NOT NULL
	);

select count(*) from MCC_WORKFLOW
select count(*) from DELETE_MCCFED_WORKFLOW

CREATE TABLE DELETE_MCCFED_CCM_DOC_CATEGORY (
    SEQUENCE_NUM decimal(10,0) NOT NULL
	);

select count(*) from CCM_DOC_CATEGORY
select count(*) from DELETE_MCCFED_CCM_DOC_CATEGORY

CREATE TABLE DELETE_MCCFED_CCM_DOC_FOLDER (
    SEQUENCE_NUM int NOT NULL
	);

select count(*) from CCM_DOC_FOLDER
select count(*) from DELETE_MCCFED_CCM_DOC_FOLDER

CREATE TABLE DELETE_MCCFED_CCM_DOC_XREF (
    SEQUENCE_NUM decimal(10,0) NOT NULL
	);

select count(*) from CCM_DOC_XREF
select count(*) from DELETE_MCCFED_CCM_DOC_XREF

CREATE TABLE DELETE_MCCFED_CCM_ECONFIRM_DATA_SUBMIT (
    CEB_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from CCM_ECONFIRM_DATA_SUBMIT
select count(*) from DELETE_MCCFED_CCM_ECONFIRM_DATA_SUBMIT

CREATE TABLE DELETE_MCCFED_CCM_ECONFIRM_TRADE_DETAIL (
    ETD_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from CCM_ECONFIRM_TRADE_DETAIL
select count(*) from DELETE_MCCFED_CCM_ECONFIRM_TRADE_DETAIL

CREATE TABLE DELETE_MCCFED_CCM_DOC_DEX_XREF (
    TRDG_COMP_MNEM nvarchar(500) NOT NULL,
	CONTRACT_NUM nvarchar(500) NOT NULL,
	PRCL_SEQ_NUM nvarchar(500) NOT NULL,
    DOC_SEQ_NUM decimal(10,0) NOT NULL,
	CONTRACT_CREATE_D datetime NOT NULL
	);

select count(*) from CCM_DOC_DEX_XREF
select count(*) from DELETE_MCCFED_CCM_DOC_DEX_XREF

CREATE TABLE DELETE_MCCFED_CCM_DOC_DOCUMENT (
    DOC_KEY decimal(10,0) NOT NULL
	);

select count(*) from CCM_DOC_DOCUMENT
select count(*) from DELETE_MCCFED_CCM_DOC_DOCUMENT

CREATE TABLE DELETE_MCCFED_CCM_ECONFIRM_ERROR_LOG (
    CEE_SEQ_NUM decimal(9,0) NOT NULL
	);

select count(*) from CCM_ECONFIRM_ERROR_LOG
select count(*) from DELETE_MCCFED_CCM_ECONFIRM_ERROR_LOG

select count(*) from DEX_PRICING
select count(*) from DELETE_DEX_PRICING

delete from DEX_PRICING where PRICING_SEQ_NUM IN (select PRICING_SEQ_NUM from DEX_PRICING where CONCAT(SEQUENCE_NUM, '\', ARCHIVED_IND) NOT IN (select CONCAT(SEQUENCE_NUM, '\', ARCHIVED_IND) from DELETE_DEX_PRICING))

select count(*) from DEX_CHRGACCT

ALTER TABLE DEX_CHRGACCT
  DROP CONSTRAINT IF EXISTS DEX_CHRGACCT_pk

ALTER TABLE DEX_CHRGACCT
DROP COLUMN IF EXISTS CHRGACCT_SEQ_NUM;

alter table DEX_CHRGACCT
add CHRGACCT_SEQ_NUM int identity(1,1)

ALTER TABLE DEX_CHRGACCT
  ADD CONSTRAINT DEX_CHRGACCT_pk 
    PRIMARY KEY (CHRGACCT_SEQ_NUM);

alter table MCC_DOC_CONTRACT_XREF
add DOC_CONTRACT_XREF_SEQ_NUM int identity(1,1)

ALTER TABLE MCC_DOC_CONTRACT_XREF
  ADD CONSTRAINT MCC_DOC_CONTRACT_XREF_pk 
    PRIMARY KEY (DOC_CONTRACT_XREF_SEQ_NUM);

alter table CCM_ECONFIRM_REPORT
add REPORT_SEQ_NUM int identity(1,1)

ALTER TABLE CCM_ECONFIRM_REPORT
  ADD CONSTRAINT CCM_ECONFIRM_REPORT_pk 
    PRIMARY KEY (REPORT_SEQ_NUM);

select top 100 * from CCM_ECONFIRM_REPORT order by REPORT_SEQ_NUM desc
select count(*) from CCM_ECONFIRM_REPORT

select top 25000 * from DEX_PARCEL order by PARCEL_SEQ_NUM asc
select top 25000 * from DEX_PARCEL

select count(*) from DEX_PARCEL
select count(*) from DELETE_DEX_PARCEL

delete from DEX_PARCEL where PARCEL_SEQ_NUM IN (
select PARCEL_SEQ_NUM from DEX_PARCEL where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', PRCL_SEQ_NUM, '\', ARCHIVED_IND, '\', CONVERT(nvarchar, CONTRACT_CREATE_D))   NOT IN (select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', PRCL_SEQ_NUM, '\', ARCHIVED_IND, '\', CONVERT(nvarchar, CONTRACT_CREATE_D)) from DELETE_DEX_PARCEL) order by PARCEL_SEQ_NUM asc
)

CREATE TABLE ALIGNE_BOOK (
    BOOK_ACTIVE decimal(5,0) NULL,
	BOOK_AGEN decimal(5,0) NULL,
	BOOK_AOP0 nvarchar(4) NULL,
	BOOK_ADATE0 datetime NULL,
	BOOK_ATIME0 decimal(5,0) NULL,
	BOOK_AOP1 nvarchar(4) NULL,
	BOOK_ADATE1 datetime NULL,
	BOOK_ATIME1 decimal(5,0) NULL,
	BOOK_ALF datetime NULL,
	BOOK_AOHM datetime NULL,
	BOOK_ROHM datetime NULL,
	BOOK_REFRESH decimal(10,0) NOT NULL,
	BOOK_ZKEY decimal(10,0) NOT NULL,
	BOOK_XKEY decimal(10,0) NOT NULL,
	BOOK_UTIL1 decimal(10,0) NOT NULL,
	BOOK_UTIL2 decimal(10,0) NOT NULL,
	BOOK_BOOK nvarchar(4) NOT NULL,
	BOOK_DSC nvarchar(24) NULL,
	BOOK_SUBDATAGRP nvarchar(16) NOT NULL,
	BOOK_ZGRID nvarchar(10) NULL,
	BOOK_ACCT nvarchar(70) NULL,
	BOOK_ATTR1 nvarchar(10) NULL,
	BOOK_ATTR2 nvarchar(10) NULL,
	BOOK_ATTR3 nvarchar(10) NULL,
	BOOK_ATTR4 nvarchar(10) NULL,
	BOOK_ATTR5 nvarchar(10) NULL,
	BOOK_ATTR6 nvarchar(10) NULL,
	BOOK_ATTR7 nvarchar(10) NULL,
	BOOK_ATTR8 nvarchar(10) NULL,
	BOOK_ATTR9 nvarchar(10) NULL,
	BOOK_XREF nvarchar(10) NULL,
	BOOK_XREFI decimal(10,0) NULL,
	BOOK_HEDGE nvarchar(1) NULL,
	BOOK_REALTIME nvarchar(1) NULL,
	BOOK_BREAKDOWN nvarchar(1) NULL,
	BOOK_HOUSE nvarchar(10) NULL,
	BOOK_ACCTSUB1 nvarchar(25) NULL,
	BOOK_ACCTSUB2 nvarchar(25) NULL,
	BOOK_ACCTSUB3 nvarchar(25) NULL,
	BOOK_ACCTSUB4 nvarchar(25) NULL,
	BOOK_ACCTSUB5 nvarchar(25) NULL,
	BOOK_ACCTSUB6 nvarchar(25) NULL,
	BOOK_SECID decimal(5,0) NOT NULL,
	BOOK_HSEC nvarchar(1) NOT NULL,
	BOOK_CCY nvarchar(6) NULL,
	BOOK_BUSUNIT nvarchar(10) NULL,
	BOOK_PROFITCENTER nvarchar(10) NULL);


select * from ALIGNE_BOOK

select count(*) from ALIGNE_BOOK
select count(distinct BOOK_REFRESH) from ALIGNE_BOOK

alter table ALIGNE_BOOK
add BOOK_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_BOOK
  ADD CONSTRAINT ALIGNE_BOOK_pk 
    PRIMARY KEY (BOOK_SEQ_NUM);

alter table ALIGNE_CONTRACT
add CONTRACT_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_CONTRACT
  ADD CONSTRAINT ALIGNE_CONTRACT_pk 
    PRIMARY KEY (CONTRACT_SEQ_NUM);
 
select * from ALIGNE_CONTRACT

alter table ALIGNE_CONTRACTAUX
add CONTRACTAUX_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_CONTRACTAUX
  ADD CONSTRAINT ALIGNE_CONTRACTaux_pk 
    PRIMARY KEY (CONTRACTAUX_SEQ_NUM);
 
select * from ALIGNE_CONTRACTAUX

alter table ALIGNE_CPTY
add CPTY_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_CPTY
  ADD CONSTRAINT ALIGNE_CPTY_pk 
    PRIMARY KEY (CPTY_SEQ_NUM);
 
select * from ALIGNE_CPTY

alter table ALIGNE_CPTYAUX
add CPTYAUX_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_CPTYAUX
  ADD CONSTRAINT ALIGNE_CPTYAUX_pk 
    PRIMARY KEY (CPTYAUX_SEQ_NUM);
 
select * from ALIGNE_CPTYAUX

alter table ALIGNE_MKT
add MKT_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_MKT
  ADD CONSTRAINT ALIGNE_MKT_pk 
    PRIMARY KEY (MKT_SEQ_NUM);
 
select * from ALIGNE_MKT

alter table ALIGNE_MRKTC
add MRKTC_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_MRKTC
  ADD CONSTRAINT ALIGNE_MRKTC_pk 
    PRIMARY KEY (MRKTC_SEQ_NUM);
 
select * from ALIGNE_MRKTC

alter table ALIGNE_SAP_MASTER_TRADES
add SAP_MASTER_TRADES_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_SAP_MASTER_TRADES
  ADD CONSTRAINT SAP_MASTER_TRADES_pk 
    PRIMARY KEY (SAP_MASTER_TRADES_SEQ_NUM);
 
select * from ALIGNE_SAP_MASTER_TRADES

select count(*) from ALIGNE_TPOW

select count(distinct TRADE_TNUM) from ALIGNE_TPOW

select count(distinct CONCAT(AUDIT_UTIL2, '\', AUDIT_XKEY, '\', AUDIT_UTIL1, '\', AUDIT_ZKEY)) from ALIGNE_TPOW

drop table ALIGNE_CONTRACT

CREATE TABLE ALIGNE_CONTRACT (
    AUDIT_ACTIVE decimal(5,0) NULL,
	AUDIT_AGEN decimal(5,0) NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0 decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(4) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NULL,
	AUDIT_AOHM datetime2(0) NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NOT NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	CONTRACT_CPTY nvarchar(10) NOT NULL,
	CONTRACT_MANUM nvarchar(15) NOT NULL,
	CONTRACT_DSC nvarchar(32) NOT NULL,
	CONTRACT_CPREF nvarchar(20) NULL,
	CONTRACT_EFFDT datetime2(0) NOT NULL,
	CONTRACT_EXPDT datetime2(0) NOT NULL,
	CONTRACT_LOUDT datetime2(0) NULL,
	CONTRACT_CONSNC nvarchar(10) NULL,
	CONTRACT_CONTYPE nvarchar(10) NULL,
	CONTRACT_EXEC nvarchar(1) NOT NULL,
	CONTRACT_PRRTY nvarchar(10) NULL,
	CONTRACT_STATUS nvarchar(10) NULL,
	CONTRACT_NETTING nvarchar(10) NULL,
	CONTRACT_MGR nvarchar(32) NULL,
	CONTRACT_BANK nvarchar(35) NULL,
	CONTRACT_ABAAC nvarchar(15) NULL,
	CONTRACT_ABART nvarchar(15) NULL,
	CONTRACT_BILLON decimal(10,0) NULL,
	CONTRACT_PAYON decimal(10,0) NULL,
	CONTRACT_PAYDYS decimal(10,0) NULL,
	CONTRACT_BIZCAL nvarchar(1) NULL,
	CONTRACT_MINMAX nvarchar(1) NULL,
	CONTRACT_TYPE nvarchar(1) NULL,
	CONTRACT_MATYPE nvarchar(1) NULL,
	CONTRACT_SETTLECALTYPE nvarchar(1) NULL,
	CONTRACT_VOLUME decimal(38,0) NULL,
	CONTRACT_UNITS nvarchar(10) NULL,
	CONTRACT_POWER nvarchar(1) NULL,
	CONTRACT_GAS nvarchar(1) NULL,
	CONTRACT_CRUDE nvarchar(1) NULL,
	CONTRACT_COAL nvarchar(1) NULL,
	CONTRACT_FX nvarchar(1) NULL,
	CONTRACT_FREIGHT nvarchar(1) NULL,
	CONTRACT_BIOENERGY nvarchar(1) NULL,
	CONTRACT_METALS nvarchar(1) NULL,
	CONTRACT_HEAT nvarchar(1) NULL,
	CONTRACT_HASDETAILS nvarchar(1) NULL,
	CONTRACT_PROFILE nvarchar(15) NULL,
	CONTRACT_PHYS nvarchar(1) NULL,
	CONTRACT_SWAP nvarchar(1) NULL,
	CONTRACT_OTCOP nvarchar(1) NULL,
	CONTRACT_CONFBAT nvarchar(20) NULL,
	CONTRACT_INVOBAT nvarchar(20) NULL,
	CONTRACT_INVCONT nvarchar(4) NULL,
	CONTRACT_NOTCONT nvarchar(4) NULL,
	CONTRACT_STATEGOV nvarchar(10) NULL,
	CONTRACT_GENER nvarchar(10) NULL,
	CONTRACT_DATE1 datetime2(0) NULL,
	CONTRACT_DATE2 datetime2(0) NULL,
	CONTRACT_MEMO1 nvarchar(80) NULL,
	CONTRACT_MEMO2 nvarchar(80) NULL,
	CONTRACT_MEMO3 nvarchar(80) NULL,
	CONTRACT_DOCFILE nvarchar(300) NULL,
	CONTRACT_COLTERMS nvarchar(1) NULL,
	CONTRACT_HTHRESH decimal(10,0) NULL,
	CONTRACT_HMTA decimal(10,0) NULL,
	CONTRACT_HINDAMT decimal(10,0) NULL,
	CONTRACT_HROUND decimal(10,0) NULL,
	CONTRACT_CTHRESH decimal(10,0) NULL,
	CONTRACT_CMTA decimal(10,0) NULL,
	CONTRACT_CINDAMT decimal(10,0) NULL,
	CONTRACT_CROUND decimal(10,0) NULL,
	CONTRACT_SECID decimal(5,0) NOT NULL,
	CONTRACT_TIMEZONE nvarchar(7) NULL,
	CONTRACT_TRANS nvarchar(1) NULL,
	CONTRACT_BS nvarchar(1) NULL,
	CONTRACT_DEFAULT nvarchar(1) NULL,
	CONTRACT_FIRM nvarchar(10) NULL,
	CONTRACT_ATTR1 nvarchar(10) NULL,
	CONTRACT_ATTR2 nvarchar(10) NULL,
	CONTRACT_ATTR3 nvarchar(10) NULL,
	CONTRACT_ATTR4 nvarchar(10) NULL,
	CONTRACT_ATTR5 nvarchar(10) NULL,
	CONTRACT_COLMATRIX nvarchar(1) NULL,
	CONTRACT_DATE1_LABEL nvarchar(10) NULL,
	CONTRACT_DATE2_LABEL nvarchar(10) NULL,
	CONTRACT_DATE3_LABEL nvarchar(10) NULL,
	CONTRACT_DATE4_LABEL nvarchar(10) NULL,
	CONTRACT_DATE5_LABEL nvarchar(10) NULL,
	CONTRACT_DATE3 datetime2(0) NULL,
	CONTRACT_DATE4 datetime2(0) NULL,
	CONTRACT_DATE5  datetime2(0) NULL,
	CONTRACT_STARTDT datetime2(0) NULL,
	CONTRACT_ENDDT datetime2(0) NULL,
	CONTRACT_BILLBIZCAL nvarchar(1) NULL,
	CONTRACT_EMIS nvarchar(1) NULL,
	CONTRACT_HOUSE nvarchar(10) NULL,
	CONTRACT_STAMP decimal(10,0) NULL,
);

drop table ALIGNE_CONTRACT

select * from ALIGNE_CONTRACT

select count(*) from ALIGNE_CONTRACT
select count(distinct ...) from ALIGNE_CONTRACT

alter table ALIGNE_CONTRACT
add CONTRACT_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_CONTRACT
  ADD CONSTRAINT ALIGNE_CONTRACT_pk 
    PRIMARY KEY (CONTRACT_SEQ_NUM);

ALTER TABLE ALIGNE_CONTRACT
  DROP CONSTRAINT IF EXISTS ALIGNE_CONTRACT_pk

ALTER TABLE ALIGNE_CONTRACT
DROP COLUMN IF EXISTS CONTRACT_SEQ_NUM;

CREATE USER [MDENTON] WITH PASSWORD = 'Secret3412';
ALTER ROLE [db_datareader] ADD MEMBER [MyUser]; -- or sp_addrolemember

CREATE USER MDENTON FROM LOGIN MDENTON;

CREATE TABLE ALIGNE_CONTRACTAUX (
    CONTRACTAUX_REFRESH decimal(10,0) NOT NULL,
	CONTRACTAUX_A_GBO_EXCEPTION nvarchar(30) NULL,
	CONTRACTAUX_A_TAX_EXCEPTION nvarchar(30) NULL,
	CONTRACTAUX_A_CSA nvarchar(30) NULL,
	CONTRACTAUX_A_MA_CATEGORY nvarchar(30) NULL,
	CONTRACTAUX_A_MNA nvarchar(30) NULL
);

drop table ALIGNE_CONTRACTAUX

select * from ALIGNE_CONTRACT

select count(*) from ALIGNE_CONTRACT
select count(distinct ...) from ALIGNE_CONTRACT

alter table ALIGNE_CONTRACT
add CONTRACT_SEQ_NUM int identity(1,1)

ALTER TABLE ALIGNE_CONTRACT
  ADD CONSTRAINT ALIGNE_CONTRACT_pk 
    PRIMARY KEY (CONTRACT_SEQ_NUM);

ALTER TABLE ALIGNE_CONTRACT
  DROP CONSTRAINT IF EXISTS ALIGNE_CONTRACT_pk

ALTER TABLE ALIGNE_CONTRACT
DROP COLUMN IF EXISTS CONTRACT_SEQ_NUM;


select count(*) from MCC_PERSONNEL

drop table ALIGNE_TPOW

CREATE TABLE ALIGNE_TPOW (
    AUDIT_ACTIVE decimal(5,0) NULL,
	AUDIT_AGEN decimal(5,0) NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0 decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(10) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NULL,
	AUDIT_AOHM datetime2(0) NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	TRADE_TNUM  nvarchar(10) NULL,
	TRADE_STATUS decimal(10,0) NULL,
	TRADE_VOID nvarchar(10) NULL,
	TRADE_TRDTYP nvarchar(10) NULL,
	TRADE_PARENT nvarchar(10) NULL,
	TRADE_PRTGEN decimal(5,0) NULL,
	TRADE_PRTTYP nvarchar(10) NULL,
	TRADE_CHILD1 nvarchar(10) NULL,
	TRADE_CHILD2 nvarchar(10) NULL,
	TRADE_TDATE datetime2(0) NULL,
	TRADE_GROUP nvarchar(10) NULL,
	TRADE_SGROUP nvarchar(10) NULL,
	TRADE_GROUP3 nvarchar(10) NULL,
	TRADE_GROUP4 nvarchar(10) NULL,
	TRADE_CPTY nvarchar(10) NULL,
	TRADE_MANUM nvarchar(15) NULL,
	TRADE_CCOMM nvarchar(10) NULL,
	TRADE_CCSCHED nvarchar(10) NULL,
	TRADE_CCFORM decimal(5,0) NULL,
	TRADE_CCAMT float(49) NULL,
	TRADE_CCUNIT float(49) NULL,
	TRADE_CCCY nvarchar(10) NULL,
	TRADE_BRO nvarchar(10) NULL,
	TRADE_BCOMM nvarchar(10) NULL,
	TRADE_BCSCHED nvarchar(10) NULL,
	TRADE_BCFORM decimal(5,0) NULL,
	TRADE_BCAMT float(49) NULL,
	TRADE_BCUNIT float(49) NULL,
	TRADE_BCCY nvarchar(10) NULL,
	TRADE_SALES nvarchar(10) NULL,
	TRADE_SCOMM nvarchar(10) NULL,
	TRADE_SCSCHED nvarchar(10) NULL,
	TRADE_SCFORM decimal(5,0) NULL,
	TRADE_SCAMT float(49) NULL,
	TRADE_SCUNIT float(49) NULL,
	TRADE_SCCY nvarchar(10) NULL,
	TRADE_BOOK nvarchar(10) NULL,
	TRADE_TRADER nvarchar(10) NULL,
	TRADE_TRDREX nvarchar(10) NULL,
	TRADE_FCONF nvarchar(10) NULL,
	TRADE_BCONF nvarchar(10) NULL,
	TRADE_XREF nvarchar(10) NULL,
	TRADE_XREFN float(49) NULL,
	TRADE_PLCCY nvarchar(10) NULL,
	TRADE_AMT float(49) NULL,
	TRADE_SCN decimal(5,0) NULL,
	TRADE_MEMO nvarchar(130) NULL,
	TRADE_MEMO2 nvarchar(130) NULL,
	TRADE_TORG nvarchar(10) NULL,
	TRADE_TORGTP nvarchar(10) NULL,
	TRADE_INTERTNUM nvarchar(10) NULL,
	TRADE_WHATIF nvarchar(10) NULL,
	TRADE_PROD decimal(10,0) NULL,
	TRADE_TEMPLATE decimal(10,0) NULL,
	TPOW_TPL nvarchar(32) NULL,
	TPOW_CONTACT nvarchar(10) NULL,
	TPOW_CONTACT2 nvarchar(10) NULL,
	TPOW_MKT nvarchar(10) NULL,
	TPOW_LOC nvarchar(10) NULL,
	TPOW_SCOMP1 nvarchar(10) NULL,
	TPOW_TRADETYPE nvarchar(10) NULL,
	TPOW_STARTDATE datetime2(0) NULL,
	TPOW_ENDDATE datetime2(0) NULL,
	TPOW_BCOUNT decimal(5,0) NULL,
	TPOW_TRANFLAG nvarchar(10) NULL,
	TPOW_DATEF datetime2(0) NULL,
	TPOW_DATES datetime2(0) NULL,
	TPOW_DATEE datetime2(0) NULL,
	TPOW_DAYS decimal(5,0) NULL,
	TPOW_TIMES decimal(5,0) NULL,
	TPOW_TIMEE decimal(5,0) NULL,
	TPOW_AMOUNT float(49) NULL,
	TPOW_RAMPAMT float(49) NULL,
	TPOW_PRICE float(49) NULL,
	TPOW_RAMP nvarchar(10) NULL,
	TPOW_WAAMOUNT float(49) NULL,
	TPOW_WAPRICE float(49) NULL,
	TPOW_PRICEFIXED float(49) NULL,
	TPOW_PRICEBASIS float(49) NULL,
	TPOW_PRICE2BASIS float(49) NULL,
	TPOW_PRICEPREM float(49) NULL,
	TPOW_IDXFLAG nvarchar(10) NULL,
	TPOW_IDXMKT nvarchar(10) NULL,
	TPOW_SCOMP2 nvarchar(10) NULL,
	TPOW_IDXLOC nvarchar(10) NULL,
	TPOW_RATE float(49) NULL,
	TPOW_FLOOR float(49) NULL,
	TPOW_CAP float(49) NULL,
	TPOW_CCY nvarchar(10) NULL,
	TPOW_UNIT nvarchar(10) NULL,
	TPOW_UNIT2 nvarchar(10) NULL,
	TPOW_UNITPREM nvarchar(10) NULL,
	TPOW_PERIOD nvarchar(10) NULL,
	TPOW_PERIODPRC nvarchar(10) NULL,
	TPOW_PERIODPREM nvarchar(10) NULL,
	TPOW_FIXSCHE nvarchar(10) NULL,
	TPOW_FIXSTART decimal(5,0) NULL,
	TPOW_FIXDAYS decimal(5,0) NULL,
	TPOW_FIXPSET nvarchar(10) NULL,
	TPOW_FIX2SCHE nvarchar(10) NULL,
	TPOW_FIX2START decimal(5,0) NULL,
	TPOW_FIX2DAYS decimal(5,0) NULL,
	TPOW_FIX2PSET nvarchar(10) NULL,
	TPOW_FIXMONTH1 decimal(5,0) NULL,
	TPOW_FIXMONTH2 decimal(5,0) NULL,
	TPOW_PEAKCOUNT decimal(5,0) NULL,
	TPOW_PEAKPERIOD nvarchar(10) NULL,
	TPOW_FIRM nvarchar(10) NULL,
	TPOW_FLEXLOC nvarchar(10) NULL,
	TPOW_LOSSFLAG nvarchar(10) NULL,
	TPOW_LOSSMKT nvarchar(10) NULL,
	TPOW_LOSSLOC nvarchar(10) NULL,
	TPOW_LOSSPRICE float(49) NULL,
	TPOW_LOSSRATE float(49) NULL,
	TPOW_LOSSSUP nvarchar(10) NULL,
	TPOW_LOSSIDX nvarchar(10) NULL,
	TPOW_OPT1FLAG nvarchar(10) NULL,
	TPOW_OPT1TYPE nvarchar(10) NULL,
	TPOW_OPT1MODEL nvarchar(10) NULL,
	TPOW_OPT1TRIG nvarchar(10) NULL,
	TPOW_OPT1TRIGTYPE nvarchar(10) NULL,
	TPOW_OPT1TPRICE decimal(38,0) NULL,
	TPOW_OPT1EXTYPE nvarchar(10) NULL,
	TPOW_FLEXFLAG nvarchar(10) NULL,
	TPOW_OPT1MIN float(49) NULL,
	TPOW_OPT1MAX float(49) NULL,
	TPOW_OPT1EXNUM decimal(5,0) NULL,
	TPOW_OPT1DIGTP nvarchar(10) NULL,
	TPOW_OPT1NOTTYPE nvarchar(10) NULL,
	TPOW_OPT1NOTVAL float(49) NULL,
	TPOW_OPT1NOTTIME decimal(5,0) NULL,
	TPOW_OPT1EXPDATE datetime2(0) NULL,
	TPOW_OPTVOL nvarchar(10) NULL,
	TPOW_PREM1FLAG nvarchar(10) NULL,
	TPOW_PREM1TYPE nvarchar(10) NULL,
	TPOW_PREM1VAL float(49) NULL,
	TPOW_PREM1CCY nvarchar(10) NULL,
	TPOW_PREM1PAY float(49) NULL,
	TPOW_PREM1DATE datetime2(0) NULL,
	TPOW_INV1 nvarchar(10) NULL,
	TPOW_INVLAG nvarchar(10) NULL,
	TPOW_INVLAGNUM decimal(10,0) NULL,
	TPOW_INVROUND nvarchar(10) NULL,
	TPOW_INVPREC decimal(10,0) NULL,
	TPOW_BS nvarchar(10) NULL,
	TPOW_TRANSCO nvarchar(10) NULL,
	TPOW_TRANSCA nvarchar(10) NULL,
	TPOW_TRANSDUR nvarchar(10) NULL,
	TPOW_LOSSPEAKS decimal(5,0) NULL,
	TPOW_LOSSPEAKE decimal(5,0) NULL,
	TPOW_TRANSLOSS float(49) NULL,
	TPOW_TRANSLOSS2 float(49) NULL,
	TPOW_TRANSNET nvarchar(10) NULL,
	TPOW_TRANSOASIS1 nvarchar(20) NULL,
	TPOW_TRANSOASIS2 nvarchar(20) NULL,
	TPOW_TRANSOASIS3 nvarchar(20) NULL,
	TPOW_TZ nvarchar(10) NULL,
	TPOW_SETTLECALTYPE nvarchar(10) NULL,
	TPOW_CONTRACTTYPE nvarchar(10) NULL,
	TPOW_ADHOCPERIOD nvarchar(10) NULL,
	TPOW_ADHOCDAYS nvarchar(10) NULL,
	TPOW_BILLON decimal(5,0) NULL,
	TPOW_PAYON decimal(5,0) NULL,
	TPOW_ACCTMO nvarchar(10) NULL,
	TPOW_THRESH float(49) NULL,
	TPOW_HEDGE nvarchar(10) NULL,
	TPOW_VAT float(49) NULL,
	TPOW_HDAYLOC nvarchar(10) NULL,
	TPOW_SCHED nvarchar(10) NULL,
	TPOW_HDAYMKT nvarchar(10) NULL,
	TPOW_FUNIT nvarchar(20) NULL,
	TPOW_FUNITNUM decimal(5,0) NULL,
	TPOW_OSNUM decimal(10,0) NULL,
	TPOW_OSDATE datetime2(0) NULL,
	TPOW_UTIL1 nvarchar(10) NULL,
	TPOW_UTIL2 nvarchar(10) NULL,
	TPOW_UTIL3 nvarchar(10) NULL,
	TPOW_UTIL4 nvarchar(10) NULL,
	TPOW_UTIL5 nvarchar(10) NULL,
	TPOW_TNUMGROUP nvarchar(10) NULL,
	TPOW_SOURCE decimal(10,0) NULL,
	TPOW_ECVNA nvarchar(10) NULL,
	TPOW_NOTIFIED nvarchar(10) NULL,
	TPOW_ECVNAAID nvarchar(10) NULL,
	TPOW_ECVNAAKEY nvarchar(10) NULL,
	TPOW_EFPBROH nvarchar(10) NULL,
	TPOW_EFPBROC nvarchar(10) NULL,
	TPOW_EFPPRICE float(49) NULL,
	TPOW_EFPMONTH datetime2(0) NULL,
	TPOW_EFPTRIG nvarchar(10) NULL,
	TPOW_PKGFLAG nvarchar(10) NULL,
	TPOW_PACKAGEID nvarchar(10) NULL,
	TPOW_PROVISIONID nvarchar(60) NULL,
	TPOW_GENPUR1 nvarchar(60) NULL,
	TPOW_GENPUR2 nvarchar(60) NULL,
	TPOW_GENPUR3 nvarchar(60) NULL,
	TPOW_SUBTYPE nvarchar(10) NULL,
	TPOW_ISFUTURE nvarchar(10) NULL,
	TPOW_TAMOUNT float(49) NULL,
	TPOW_TPRICE float(49) NULL,
	TPOW_ALLOWLIQGRP nvarchar(20) NULL,
);

select * from ALIGNE_TPOW

CREATE TABLE ALIGNE_TPOW2 (
	TPOW2_TNUM nvarchar(6) NOT NULL,
	TPOW2_BNUM decimal(5,0) NOT NULL,
	TPOW2_DATEF datetime2(0) NULL,
	TPOW2_DATES datetime2(0) NULL,
	TPOW2_DATEE datetime2(0) NULL,
	TPOW2_DAYS decimal(5,0) NULL,
	TPOW2_TIMES decimal(5,0) NULL,
	TPOW2_TIMEE decimal(5,0) NULL,
	TPOW2_AMOUNT float(49) NULL,
	TPOW2_RAMPAMT float(49) NULL,
	TPOW2_PRICE float(49) NULL,
	TPOW2_PRICEFIXED float(49) NULL,
	TPOW2_PRICEBASIS float(49) NULL,
	TPOW2_PRICE2BASIS float(49) NULL,
	TPOW2_PRICEPREM float(49) NULL,
	TPOW2_RAMP nvarchar(1) NULL,
	TPOW2_RATE float(49) NULL);

CREATE TABLE ALIGNE_TPOWAUX (
	TPOWAUX_TNUM nvarchar(30) NOT NULL,
	TPOWAUX_A_BUYSELL_OVERRIDE nvarchar(30) NULL,
	TPOWAUX_A_CCER_TYPE nvarchar(30) NULL,
	TPOWAUX_A_DELIVERYINTENT nvarchar(30) NULL,
	TPOWAUX_A_EXCHANGE nvarchar(30) NULL,
	TPOWAUX_A_GEN_DATE datetime2(0) NULL,
	TPOWAUX_A_1 nvarchar(100) NULL,
	TPOWAUX_A_2 nvarchar(35) NULL,
	TPOWAUX_A_3 nvarchar(30) NULL,
	TPOWAUX_A_VOLUME_CAP nvarchar(30) NULL,
	TPOWAUX_A_VOLUME_OPT nvarchar(30) NULL,
	TPOWAUX_A_PAPER_CONTRACT nvarchar(30) NULL,
	TPOWAUX_A_SAP_MASTER nvarchar(30) NULL,
	TPOWAUX_A_CPTY_TRAD_ID nvarchar(30) NULL,
	TPOWAUX_A_INSTALLATIONS nvarchar(30) NULL,
	TPOWAUX_A_PRICEOPTIONALITY nvarchar(30) NULL,
	TPOWAUX_A_SAP_CHILD nvarchar(30) NULL,
	TPOWAUX_A_MULTILEG nvarchar(30) NULL,
	TPOWAUX_A_CPTY_GC nvarchar(30) NULL,
	TPOWAUX_A_REPORTABLE nvarchar(30) NULL,
	TPOWAUX_A_SO_CPTY nvarchar(30) NULL,
	TPOWAUX_A_ACTION nvarchar(30) NULL,
	TPOWAUX_A_INSTALLATION_ID nvarchar(30) NULL,
	TPOWAUX_A_PROD_PRD_FRM datetime2(0) NULL,
	TPOWAUX_A_PROD_PRD_TO datetime2(0) NULL,
	TPOWAUX_A_ISSUE_DATE datetime2(0) NULL,
	TPOWAUX_A_EXPIRY_DATE datetime2(0) NULL,
	TPOWAUX_A_FROM_REGISTRY nvarchar(30) NULL,
	TPOWAUX_A_TO_REGISTRY nvarchar(30) NULL,
	TPOWAUX_A_AUDITDT datetime2(0) NULL,
	TPOWAUX_A_AUDITED nvarchar(30) NULL,
	TPOWAUX_A_CERTDELIVERYPRD nvarchar(30) NULL,
	TPOWAUX_A_CERTNUMBER nvarchar(30) NULL,
	TPOWAUX_A_CERTSCHEME nvarchar(30) NULL,
	TPOWAUX_A_DESTREGISTRY nvarchar(30) NULL,
	TPOWAUX_A_EXPIRYDATE datetime2(0) NULL,
	TPOWAUX_A_FEEDSTOCK nvarchar(100) NULL,
	TPOWAUX_A_GHGVALUE nvarchar(30) NULL,
	TPOWAUX_A_GASBUNDLE nvarchar(30) NULL,
	TPOWAUX_A_GASDELIVERYPRD nvarchar(30) NULL,
	TPOWAUX_A_INJECTIONDATE datetime2(0) NULL,
	TPOWAUX_A_ISSUANCEPL nvarchar(30) NULL,
	TPOWAUX_A_MASSBALTIME nvarchar(30) NULL,
	TPOWAUX_A_ORIGINCTRY nvarchar(30) NULL,
	TPOWAUX_A_ORIGINREGISTRY nvarchar(30) NULL,
	TPOWAUX_A_RECPTNUM nvarchar(30) NULL,
	TPOWAUX_A_REVOCATIONDT datetime2(0) NULL,
	TPOWAUX_A_SCHEME nvarchar(30) NULL,
	TPOWAUX_A_SUBSIDISED nvarchar(30) NULL,
	TPOWAUX_A_TRANSFERTYPE nvarchar(30) NULL,
	TPOWAUX_A_TRANSPORTCAP nvarchar(30) NULL,
	TPOWAUX_A_VALIDATIONST nvarchar(30) NULL,
	TPOWAUX_A_GENPUR1_OVER nvarchar(255) NULL,
	TPOWAUX_A_GENPUR2_OVER nvarchar(255) NULL,
	TPOWAUX_A_GENPUR3_OVER nvarchar(255) NULL,
	TPOWAUX_NOVATION_DATE nvarchar(30) NULL,
	TPOWAUX_OLDCPTY_NAME nvarchar(30) NULL,
	TPOWAUX_OLDUSI nvarchar(50) NULL,
	TPOWAUX_CAICODE nvarchar(35) NULL,
	TPOWAUX_CPBALGRP nvarchar(255) NULL,
	TPOWAUX_LEBALGRP nvarchar(255) NULL,
	TPOWAUX_A_AMEND_REASON nvarchar(30) NULL,
	TPOWAUX_A_EXPLANATION nvarchar(100) NULL,
	TPOWAUX_A_IGT_BOOK_REF nvarchar(30) NULL,
	TPOWAUX_A_OVERRIDETYPE nvarchar(30) NULL,
	TPOWAUX_A_OVERRIDEINPUT nvarchar(30) NULL,
	TPOWAUX_A_OVERRIDEFREE nvarchar(30) NULL,
	TPOWAUX_A_MATCHCODESUFFIX nvarchar(30) NULL,
	TPOWAUX_A_NOMS_PROCESSED nvarchar(30) NULL,
	TPOWAUX_A_COUNTRY_OF_ORIGIN nvarchar(30) NULL,
	TPOWAUX_A_SOURCE_OF_ENERGY nvarchar(30) NULL,
	TPOWAUX_A_SUBSIDISED_ nvarchar(30) NULL,
	TPOWAUX_A_EXPORTABLE nvarchar(30) NULL,
	TPOWAUX_A_EUGOOSFORUK nvarchar(30) NULL,
	TPOWAUX_A_OUTAGES nvarchar(30) NULL,
	TPOWAUX_A_PROJECT_CODE nvarchar(65) NULL,
	TPOWAUX_A_COMPATTR2 nvarchar(30) NULL
);

CREATE TABLE ALIGNE_MKT (
	AUDIT_ACTIVE decimal(5,0) NOT NULL,
	AUDIT_AGEN decimal(5,0) NOT NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0  decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(4) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NOT NULL,
	AUDIT_AOHM datetime2(0) NOT NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NOT NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	MARKET  nvarchar(6) NULL,
	MKT_DESC nvarchar(30) NULL,
	MKT_SECID decimal(5,0) NULL,
	MARKETTYPE decimal(10,0) NULL,
	MARKETID decimal(10,0) NULL,
);

CREATE TABLE ALIGNE_MRKTC (
	MRKTC_ACTIVE decimal(5,0) NULL,
	MRKTC_AGEN decimal(5,0) NULL,
	MRKTC_AOP0 nvarchar(20) NULL,
	MRKTC_ADATE0 datetime2(0) NULL,
	MRKTC_ATIME0 decimal(5,0) NULL,
	MRKTC_AOP1 nvarchar(20) NULL,
	MRKTC_ADATE1 datetime2(0) NULL,
	MRKTC_ATIME1 decimal(5,0) NULL,
	MRKTC_ALF datetime2(0) NULL,
	MRKTC_AOHM datetime2(0) NULL,
	MRKTC_ROHM datetime2(0) NULL,
	MRKTC_REFRESH decimal(10,0) NOT NULL,
	MRKTC_ZKEY decimal(10,0) NOT NULL,
	MRKTC_XKEY decimal(10,0) NOT NULL,
	MRKTC_UTIL1 decimal(10,0) NOT NULL,
	MRKTC_UTIL2 decimal(10,0) NOT NULL,
	MRKTC_MKT nvarchar(20) NOT NULL,
	MRKTC_COMP nvarchar(20) NOT NULL,
	MRKTC_TYPE nvarchar(20) NOT NULL,
	MRKTC_FUTOPT nvarchar(20) NOT NULL,
	MRKTC_PRCY nvarchar(20) NULL,
	MRKTC_QDIGIT  decimal(5,0) NULL,
	MRKTC_QUNIT nvarchar(24) NULL,
	MRKTC_QUNITDSC nvarchar(24) NULL,
	MRKTC_ACCT nvarchar(24) NULL,
	MRKTC_ACCT2 nvarchar(24) NULL,
	MRKTC_UMKT nvarchar(24) NULL,
	MRKTC_UCOMP nvarchar(24) NULL,
	MRKTC_STL nvarchar(24) NULL,
	MRKTC_LOTTYPE nvarchar(24) NULL,
	MRKTC_LOTSIZE float(49) NULL,
	MRKTC_EXCCRS nvarchar(24) NULL,
	MRKTC_PRCMKT nvarchar(24) NULL,
	MRKTC_PDIGIT decimal(5,0) NULL,
	MRKTC_PUNIT nvarchar(24) NULL,
	MRKTC_PUNITDSC nvarchar(24) NULL,
	MRKTC_PFACT float(49) NULL,
	MRKTC_PFMT nvarchar(24) NULL,
	MRKTC_PINT float(49) NULL,
	MRKTC_KDIGIT decimal(5,0) NULL,
	MRKTC_KUNIT nvarchar(24) NULL,
	MRKTC_KFACT float(49) NULL,
	MRKTC_KFMT nvarchar(24) NULL,
	MRKTC_KINT float(49) NULL,
	MRKTC_AE nvarchar(24) NULL,
	MRKTC_PDAYS decimal(5,0) NULL,
	MRKTC_EXLAG decimal(5,0) NULL,
	MRKTC_XTIME decimal(5,0) NULL,
	MRKTC_IFMT nvarchar(24) NULL,
	MRKTC_DSC nvarchar(60) NULL,
	MRKTC_ATTR1 nvarchar(24) NULL,
	MRKTC_ATTR2 nvarchar(24) NULL,
	MRKTC_ATTR3 nvarchar(24) NULL,
	MRKTC_ATTR4 nvarchar(24) NULL,
	MRKTC_LTD nvarchar(24) NULL,
	MRKTC_PREGION nvarchar(24) NULL,
	MRKTC_IMP nvarchar(24) NULL,
	MRKTC_CNV float(49) NULL,
	MRKTC_NEARBY decimal(5,0) NULL,
	MRKTC_XREF nvarchar(24) NULL,
	MRKTC_PAYDAYS decimal(5,0) NULL,
	MRKTC_PAYTIME decimal(5,0) NULL,
	MRKTC_IDX decimal(5,0) NULL,
	MRKTC_LINELOSS float(49) NULL,
	MRKTC_GASORDER decimal(5,0) NULL,
	MRKTC_GASTIME decimal(5,0) NULL,
	MRKTC_HRBLOCK nvarchar(24) NULL,
	MRKTC_TZ nvarchar(24) NULL,
	MRKTC_GASHOURLY nvarchar(24) NULL,
	MRKTC_SUBCFLAG nvarchar(24) NULL,
	MRKTC_SCHDCOMP nvarchar(24) NULL,
	MRKTC_SECID decimal(5,0) NOT NULL,
	MRKTC_SUBTYPE nvarchar(24) NULL,
	MRKTC_SCHED nvarchar(24) NULL,
	MRKTC_INST nvarchar(24) NULL,
	MRKTC_ENABLED nvarchar(24) NOT NULL,
	MRKTC_CTRYCD nvarchar(24) NULL,
	MRKTC_TIMEBAND decimal(5,0) NULL,
	MRKTC_CREDITCD nvarchar(24) NOT NULL,
	MRKTC_SPEC nvarchar(24) NULL,
	MRKTC_COMMODITYID decimal(10,0) NULL,
	MRKTC_DFANAME nvarchar(24) NULL,
	MRKTC_LOCATIONID decimal(10,0) NULL,
	MRKTC_LIQUIDATE nvarchar(24) NULL,
	MRKTC_LIQTYPE nvarchar(24) NULL,
	MRKTC_ALLOWLIQGRP nvarchar(24) NULL,
);

CREATE TABLE ALIGNE_CONTRACT_MULTICPTY (
    AUDIT_ACTIVE decimal(5,0) NOT NULL,
	AUDIT_AGEN decimal(5,0) NOT NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0 decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(4) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NOT NULL,
	AUDIT_AOHM datetime2(0) NOT NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NOT NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	MULTI_MANUM nvarchar(15) NULL,
	MULTI_CPTY nvarchar(10) NULL,
);

drop table ALIGNE_CONTRACT_MULTICPTY

CREATE TABLE ALIGNE_CONTRACT_MULTIHOUSE (
    AUDIT_ACTIVE decimal(5,0) NOT NULL,
	AUDIT_AGEN decimal(5,0) NOT NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0 decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(4) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NOT NULL,
	AUDIT_AOHM datetime2(0) NOT NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NOT NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	MULTI_MANUM nvarchar(15) NULL,
	MULTI_HOUSE nvarchar(10) NULL,
);

drop table ALIGNE_CONTRACT_MULTIHOUSE

CREATE TABLE ALIGNE_CONTRACT_SUBTYPE (
    AUDIT_ACTIVE decimal(5,0) NOT NULL,
	AUDIT_AGEN decimal(5,0) NOT NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0 decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(4) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NOT NULL,
	AUDIT_AOHM datetime2(0) NOT NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NOT NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	CONSUB_CPTY nvarchar(10) NOT NULL,
	CONSUB_MANUM nvarchar(15) NOT NULL,
	CONSUB_SUBTYPE nvarchar(10) NOT NULL,
	CONSUB_CFTYPE nvarchar(1) NOT NULL,
	CONSUB_MKT nvarchar(10) NOT NULL,
	CONSUB_COMP nvarchar(10) NOT NULL,
	CONSUB_CONTRACTTYPE nvarchar(10) NOT NULL,
	CONSUB_MASETTLPRD nvarchar(10) NOT NULL,
	CONSUB_BILLON decimal(10,0) NOT NULL,
	CONSUB_PAYON decimal(10,0) NOT NULL,
	CONSUB_PAYDYS decimal(10,0) NOT NULL,
	CONSUB_BILLBIZCAL nvarchar(10) NOT NULL,
	CONSUB_PAYBIZCAL nvarchar(10) NOT NULL,
	CONSUB_MINMAX nvarchar(10) NOT NULL,
);

drop table ALIGNE_CONTRACT_SUBTYPE

CREATE TABLE ALIGNE_CPTY (
    CPTY_ACTIVE decimal(5,0) NULL,
	CPTY_AGEN decimal(5,0) NULL,
	CPTY_AOP0 nvarchar(4) NULL,
	CPTY_ADATE0 datetime2(0) NULL,
	CPTY_ATIME0 decimal(5,0) NULL,
	CPTY_AOP1 nvarchar(4) NULL,
	CPTY_ADATE1 datetime2(0) NULL,
	CPTY_ATIME1 decimal(5,0) NULL,
	CPTY_ALF datetime2(0) NULL,
	CPTY_AOHM datetime2(0) NULL,
	CPTY_ROHM datetime2(0) NULL,
	CPTY_REFRESH decimal(10,0) NOT NULL,
	CPTY_ZKEY decimal(10,0) NOT NULL,
	CPTY_XKEY decimal(10,0) NOT NULL,
	CPTY_UTIL1 decimal(10,0) NOT NULL,
	CPTY_UTIL2 decimal(10,0) NOT NULL,
	CPTY_CPTY nvarchar(10) NOT NULL,
	CPTY_BRO nvarchar(10) NULL,
	CPTY_UVAL nvarchar(10) NULL,
	CPTY_CITY nvarchar(10) NULL,
	CPTY_DSC nvarchar(128) NULL,
	CPTY_ACCT nvarchar(16) NULL,
	CPTY_CONTACT nvarchar(80) NULL,
	CPTY_TELEPHONE nvarchar(24) NULL,
	CPTY_FAX nvarchar(24) NULL,
	CPTY_TELEX nvarchar(24) NULL,
	CPTY_EMAIL nvarchar(50) NULL,
	CPTY_ADDR1 nvarchar(32) NULL,
	CPTY_ADDR2 nvarchar(32) NULL,
	CPTY_ADDR3 nvarchar(32) NULL,
	CPTY_ADDR4 nvarchar(32) NULL,
	CPTY_CTRYCD nvarchar(4) NULL,
	CPTY_TYPE nvarchar(1) NOT NULL,
	CPTY_CONFIRM  nvarchar(1) NULL,
	CPTY_NETGROSS nvarchar(32) NULL,
	CPTY_PLCCY nvarchar(6) NULL,
	CPTY_NETA nvarchar(1) NULL,
	CPTY_SWIFT nvarchar(24) NULL,
	CPTY_PAYID nvarchar(24) NULL,
	CPTY_PARENT nvarchar(10) NULL,
	CPTY_XREF nvarchar(10) NULL,
	CPTY_XREF2 nvarchar(20) NULL,
	CPTY_XREF3 nvarchar(10) NULL,
	CPTY_XREF4 nvarchar(10) NULL,
	CPTY_XREFI decimal(10,0) NULL,
	CPTY_XREFN float(49) NULL,
	CPTY_XREFN2 float(49) NULL,
	CPTY_COMM nvarchar(10) NULL,
	CPTY_CHOUSE nvarchar(10) NULL,
	CPTY_LOC nvarchar(10) NULL,
	CPTY_SALES nvarchar(10) NULL,
	CPTY_ZGRID nvarchar(10) NULL,
	CPTY_NOVATE nvarchar(1) NULL,
	CPTY_PREC1 decimal(5,0) NULL,
	CPTY_FORM1 nvarchar(1) NULL,
	CPTY_PREC2 decimal(5,0) NULL,
	CPTY_FORM2 nvarchar(1) NULL,
	CPTY_IDATE datetime2(0) NULL,
	CPTY_MARG nvarchar(10) NULL,
	CPTY_LIQ nvarchar(10) NULL,
	CPTY_CONTRACT nvarchar(10) NULL,
	CPTY_BID nvarchar(10) NULL,
	CPTY_OFFER nvarchar(10) NULL,
	CPTY_RSET nvarchar(10) NULL,
	CPTY_LOU datetime2(0) NULL,
	CPTY_MKTBASED datetime2(0) NULL,
	CPTY_COSTBASED datetime2(0) NULL,
	CPTY_PPAGMT datetime2(0) NULL,
	CPTY_COSTREF nvarchar(15) NULL,
	CPTY_POWERP nvarchar(1) NULL,
	CPTY_POWERT nvarchar(1) NULL,
	CPTY_POWERG nvarchar(1) NULL,
	CPTY_POWERL nvarchar(1) NULL,
	CPTY_POWERS nvarchar(1) NULL,
	CPTY_APPROVED nvarchar(1) NULL,
	CPTY_APPROVEDDSC nvarchar(255) NULL,
	CPTY_RECOVERYRATE float(49),
	CPTY_DUNS nvarchar(15) NULL,
	CPTY_NERC nvarchar(10) NULL,
	CPTY_SECID decimal(5,0) NOT NULL,
	CPTY_EXPIREDATE datetime2(0) NULL,
	CPTY_ATTR1 nvarchar(10) NULL,
	CPTY_ATTR2 nvarchar(10) NULL,
	CPTY_ATTR3 nvarchar(10) NULL,
	CPTY_ATTR4 nvarchar(10) NULL,
	CPTY_DFAID nvarchar(32) NULL
);

drop table ALIGNE_CPTY

CREATE TABLE ALIGNE_CPTYAUX (
    CPTYAUX_REFRESH decimal(10,0) NOT NULL,
	CPTYAUX_A_CRED_OVERRIDE nvarchar(35) NULL,
	CPTYAUX_A_CPTY_CAT nvarchar(35) NULL,
	CPTYAUX_A_REGSTR_NO nvarchar(35) NULL,
	CPTYAUX_A_RATING_ID nvarchar(35) NULL,
	CPTYAUX_A_MIFID_COMPLIANT nvarchar(35) NULL,
	CPTYAUX_A_EMIR_COMPLIANT nvarchar(35) NULL,
	CPTYAUX_A_EMIR_INTRA nvarchar(35) NULL,
	CPTYAUX_A_US_PERSON nvarchar(35) NULL,
	CPTYAUX_A_SANCTION_TYPE nvarchar(35) NULL,
	CPTYAUX_A_SANCTION_ID nvarchar(35) NULL,
	CPTYAUX_A_START datetime2(0) NULL,
	CPTYAUX_A_END datetime2(0) NULL,
	CPTYAUX_A_CPTY_TYPE nvarchar(35) NULL,
);

drop table ALIGNE_CPTYAUX

ALIGNE_MASTER_AGREEMENT

CREATE TABLE ALIGNE_MASTER_AGREEMENT (
    AUDIT_ACTIVE decimal(5,0) NULL,
	AUDIT_AGEN decimal(5,0) NULL,
	AUDIT_AOP0 nvarchar(4) NULL,
	AUDIT_ADATE0 datetime2(0) NULL,
	AUDIT_ATIME0 decimal(5,0) NULL,
	AUDIT_AOP1 nvarchar(4) NULL,
	AUDIT_ADATE1 datetime2(0) NULL,
	AUDIT_ATIME1 decimal(5,0) NULL,
	AUDIT_ALF datetime2(0) NULL,
	AUDIT_AOHM datetime2(0) NULL,
	AUDIT_ROHM datetime2(0) NULL,
	AUDIT_REFRESH decimal(10,0) NOT NULL,
	AUDIT_ZKEY decimal(10,0) NOT NULL,
	AUDIT_XKEY decimal(10,0) NOT NULL,
	AUDIT_UTIL1 decimal(10,0) NOT NULL,
	AUDIT_UTIL2 decimal(10,0) NOT NULL,
	NETTINGCONTRACT_NANUM nvarchar(15) NOT NULL,
	CONTRACT_MANUM nvarchar(15) NULL,
);

drop table ALIGNE_MASTER_AGREEMENT

CREATE TABLE ALIGNE_SAP_MASTER_TRADES (
    DEALNUMBER nvarchar(500) NOT NULL,
	INSTALLATIONID nvarchar(100) NOT NULL,
	COMPANYCODE nvarchar(20) NOT NULL,
	STARTDATE datetime2(0) NULL,
	ENDDATE datetime2(0) NULL,
	PAPERCONTRACTID nvarchar(200) NULL,
	LATESTCONTRACT nvarchar(100) NULL,
	MARKETCOMPONENT nvarchar(100) NULL,
	ACTIONTYPE nvarchar(20) NOT NULL,
	TRADERID nvarchar(20) NULL,
	BUSINESSPARTNERID nvarchar(20) NULL,
	BUSINESSPARTNERDESC nvarchar(200) NULL,
	TRADETYPE_2 nvarchar(20) NOT NULL,
	SAPTRADETYPE nvarchar(20) NULL,
	CVPTYPE nvarchar(20) NULL,
	PRICETYPE nvarchar(20) NULL,
	REFERENCEPRICE nvarchar(20) NULL,
	PRICEUNIT nvarchar(20) NULL,
	SETTLEMENTMETHOD nvarchar(20) NULL,
	TRANSACTIONDATETIME nvarchar(20) NOT NULL,
	FORMULANUMBER nvarchar(20) NULL,
	LINE1 nvarchar(200) NULL,
	LINE2 nvarchar(200) NULL,
	LINE3 nvarchar(200) NULL,
	LINE4 nvarchar(200) NULL,
	LINE5 nvarchar(200) NULL,
	RECORDCREATIONDATETIME nvarchar(20) NOT NULL,
	RECORDCHANGEDATETIME nvarchar(20) NOT NULL,
	BUYSELL  nvarchar(1) NULL,
	ZKEY nvarchar(100) NULL,
	EXITGRID nvarchar(200) NULL,
	REMITREPORTABLE nvarchar(1) NULL,
	STPCOMMENTS nvarchar(500) NULL,
	STPPICKUPDATETIME datetime2(0) NULL,
	PROCESSED nvarchar(1) NOT NULL,
	VOLUMEOPT nvarchar(100) NULL,
	VOLUMEOPT_CAPACITY nvarchar(100) NULL,
	VOLUMEOPT_FREQ nvarchar(100) NULL,
	VOLUMEOPT_INTERVAL nvarchar(100) NULL,
	NOTIONALQTY_UNIT nvarchar(20) NULL,
	UTI nvarchar(100) NULL,
	DAYMASK nvarchar(20) NULL,
	CUST_TRADERID nvarchar(20) NULL,
	TOTALINSTALLATIONS nvarchar(20) NULL,
	FORMULA_DESC nvarchar(500) NULL,
	PRICE_OPT  nvarchar(20) NULL,
);

drop table ALIGNE_SAP_MASTER_TRADES

select count(*) from DEX_CDTYCTMT where last_update_tstmp = last_run_tstmp

select count(*) from DEX_CDTYCTMT where last_run_tstmp >= last_update_tstmp
select count(*) from DEX_CDTYCTMT

select count(*) from DEX_CDTYCTMT where last_update_tstmp is NULL

select * from DEX_CDTYCTMT where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', ARCHIVED_IND, '\', CONTRACT_CREATE_D) IN (
select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', ARCHIVED_IND, '\', CONTRACT_CREATE_D) from DEX_CDTYCTMT where last_run_tstmp >= last_update_tstmp) 
AND last_run_tstmp > '2022-10-25 13:00:00'

select * from DEX_CDTYCTMT where CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', ARCHIVED_IND, '\', CONTRACT_CREATE_D) IN (
select CONCAT(TRDG_COMP_MNEM, '\', CONTRACT_NUM, '\', CTMT_SEQ_NUM, '\', ARCHIVED_IND, '\', CONTRACT_CREATE_D) from DEX_CDTYCTMT where last_update_tstmp >= last_run_tstmp) 
AND last_update_tstmp > '2022-10-25 13:00:00'

select * from DEX_CDTYCTMT where last_run_tstmp is null

select *, 
case
when ISNULL(last_update_tstmp, '01-01-1753') > iSNULL(last_run_tstmp, '01-01-1753') then last_update_tstmp
else last_run_tstmp
end as GREATEST_UPDATE_TSTMP
from DEX_CDTYCTMT where last_update_tstmp >= last_run_tstmp

select top 100 last_update_tstmp, last_run_tstmp from DEX_GRADE

select top 100 * from DEX_COMPANY where last_run_tstmp <= last_update_tstmp

select count(*) from MCC_PERSONNEL

select * from MCC_PERSONNEL

alter  table MCC_PERSONNEL
alter column FIRST_NAME nvarchar(MAX);

select top 100*from MCC_PROCESS_INSTANCE

select count(*) from MCC_PROCESS_INSTANCE

select top 1 * from ALIGNE_USR

select count(*) from CCM_DOC_DOCUMENT

ALTER TABLE ALIGNE_CONTRACTAUX
DROP COLUMN CONTRACTAUX_SEQ_NUM;

ALTER TABLE ALIGNE_CONTRACTAUX
DROP CONSTRAINT ALIGNE_CONTRACTAUX_pk;

ALTER TABLE ALIGNE_CONTRACTAUX
ADD CONTRACTAUX_A_MARKET nvarchar(30) NULL;

select count(distinct DEALS_DONE_REG_IND) from DEX_CONTRACT

select count(*) from CCM_IFACE

select * from CCM_IFACE where transaction_type = 'M2M' and srce_system_code in ('DEX','ZAINET')

select (TRY_CAST(REPLACE (TRY_CAST (TRADE_DETAILS_XML AS VARCHAR(MAX)), 'encoding="ISO-8859-1"', '')
AS XML).value('(/M2M/VALUE/node())[1] ', 'NVARCHAR(max)' )) as M2M_Value, (TRY_CAST(REPLACE (TRY_CAST (TRADE_DETAILS_XML AS VARCHAR(MAX)), 'encoding="ISO-8859-1"', '')
AS XML).value('(/M2M/VALUATION-TSTMP/node())[1] ', 'NVARCHAR(max)' )) as M2M_Date, (TRY_CAST(REPLACE (TRY_CAST (TRADE_DETAILS_XML AS VARCHAR(MAX)), 'encoding="ISO-8859-1"', '')
AS XML).value('(/M2M/UTI/node())[1] ', 'NVARCHAR(max)' )) as UTI  from CCM_IFACE where transaction_type = 'M2M' and srce_system_code in ('DEX','ZAINET')

create table CCM_IFACE_M2M
    (CI_SEQ_NUM decimal(9,0) NOT NULL
      ,SRCE_SYSTEM_CODE nvarchar(12) NOT NULL
      ,SRCE_SYSTEM_KEY nvarchar(32) NOT NULL
      ,CON_SEQ_NUM decimal(9,0) NULL
      ,STATUS_IND nvarchar(2) NOT NULL
      ,ERROR_TXT nvarchar(2000) NULL
      ,CREATED_BY_USERID nvarchar(64) NULL
      ,CREATED_TSTMP datetime2(0) NOT NULL
      ,LAST_UPDATE_USERID nvarchar(64) NULL
      ,LAST_UPDATE_TSTMP datetime2(0) NOT NULL
      ,PRIORITY_NUM decimal(2,0) NOT NULL
      ,ACTION_IND nvarchar(1) NULL
      ,ERROR_PROCESSING_COUNT_NUM decimal(2,0) NULL
      ,XML_VERSION_NUM decimal(6,0) NULL
      ,TRADE_AMENDMENT_NUM decimal(5,0) NULL
      ,AMENDMENT_RECEIVED_TSTMP datetime2(0) NULL
      ,TRANSACTION_TYPE nvarchar(32) NULL
      ,CALLING_PROCESS_NAME nvarchar(64) NULL
      ,PROCESSING_SYSTEM nvarchar(3) NULL
	  ,M2M_Value nvarchar(MAX) NULL
	  ,M2M_Date nvarchar(MAX) NULL
	  ,UTI nvarchar(MAX) NULL
	  ,primary key(CI_SEQ_NUM)
);

drop table CCM_IFACE_M2M 

select * from CCM_IFACE_M2M

select count(*) from MCC_IFACE_STAGING

select top 10 * from CCM_IFACE

select * from MCC_IFACE_STAGING where transaction_type = 'M2M' and srce_system_code in ('DEX','ZAINET') and CREATED_TSTMP > '01-DEC-22' 

create table MCC_IFACE_STAGING_M2M
    (SIQ_SEQ_NUM decimal(10,0) NOT NULL
      ,SRCE_SYSTEM_CODE nvarchar(500) NOT NULL
      ,SRCE_SYSTEM_KEY nvarchar(500) NOT NULL
      ,STATUS_IND nvarchar(500) NOT NULL
      ,ACTION_IND nvarchar(500) NULL
      ,ERROR_PROCESSING_COUNT_NUM decimal(10,0) NULL
      ,CREATED_BY_USERID nvarchar(500) NULL
      ,CREATED_TSTMP datetime2(0) NOT NULL
      ,LAST_UPDATE_USERID nvarchar(500) NULL
      ,LAST_UPDATE_TSTMP datetime2(0) NOT NULL
      ,TRANSACTION_TYPE nvarchar(500) NULL
	  ,M2M_Value nvarchar(MAX) NULL
	  ,M2M_Date nvarchar(MAX) NULL
	  ,UTI nvarchar(MAX) NULL
	  ,primary key(SIQ_SEQ_NUM)
);



select SIQ_SEQ_NUM,
SRCE_SYSTEM_CODE,
SRCE_SYSTEM_KEY,
STATUS_IND,
ACTION_IND, 
ERROR_PROCESSING_COUNT_NUM, 
CREATED_BY_USERID, 
CREATED_TSTMP,
LAST_UPDATE_USERID, 
LAST_UPDATE_TSTMP, 
TRANSACTION_TYPE
,(TRY_CAST(REPLACE (TRY_CAST (MESSAGE_XML AS VARCHAR(MAX)), 'encoding="ISO-8859-1"', '')
AS XML).value('(/M2M/VALUE/node())[1] ', 'NVARCHAR(max)' )) as M2M_Value, (TRY_CAST(REPLACE (TRY_CAST (MESSAGE_XML AS VARCHAR(MAX)), 'encoding="ISO-8859-1"', '')
AS XML).value('(/M2M/VALUATION-TSTMP/node())[1] ', 'NVARCHAR(max)' )) as M2M_Date, (TRY_CAST(REPLACE (TRY_CAST (MESSAGE_XML AS VARCHAR(MAX)), 'encoding="ISO-8859-1"', '')
AS XML).value('(/M2M/UTI/node())[1] ', 'NVARCHAR(max)' )) as UTI  from MCC_IFACE_STAGING where transaction_type = 'M2M' and srce_system_code in ('DEX','ZAINET') and CREATED_TSTMP > '01-DEC-22' 


select * from MCC_IFACE_STAGING where transaction_type = 'M2M' and srce_system_code in ('DEX','ZAINET') and CREATED_TSTMP > '01-DEC-22'

select * from MCC_IFACE_STAGING_M2M where CREATED_TSTMP < '01-DEC-22'

select top 1 * from CCM_IFACE_M2M

select count(*) from MCC_KPI_CREPORT
select count(*) from dbo.MCC_COMMITMENT where created_tstmp > '31-DEC-17'
select count(*) from MCC_COMMITMENT where created_tstmp > '31-DEC-17' and last_update_tstmp < '01-JAN-2023'
select count(*) from MCC_COMP_REPORTABLE_ENTITY
select count(*) from MCC_CONTRACT

select count(*) from ALIGNE.BOOK

select top 100 * from MCC_CONTRACT order by created_tstmp 

select top 1 * from DEX_USR

create table DEX_LOCATION
    (SEQUENCE_NUM decimal(10,0) NOT NULL
      ,LOCATION_TYPE_RT_C nvarchar(20) NULL
      ,LOCATION_TYPE_CODE nvarchar(20) NULL
      ,LOCATION_CODE nvarchar(20) NULL
      ,LOCATION_NAME nvarchar(50) NULL
      ,ACTIVE_REC_IND nvarchar(10) NULL
      ,LAST_UPDATE_TSTMP datetime2(0) NULL
      ,DELETED_IND nvarchar(10) NULL
      ,LAST_RUN_TSTMP datetime2(0) NOT NULL
      ,SDW_VERSION_NUM decimal(10,0) NOT NULL
	  ,GREATEST_UPDATE_TSTMP datetime2(0) NULL
	  ,primary key(SEQUENCE_NUM)
);

select count(*) from CCM_IFACE

select count(*) from DEX_CONDISPT

-- Select view names:
use gcpipeline;

SELECT
    TABLE_SCHEMA
FROM INFORMATION_SCHEMA.VIEWS;

SELECT
	TABLE_NAME
FROM INFORMATION_SCHEMA.VIEWS;